<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç° - AlienZHOU's blog
  
  </title>
 <meta name="description" content="">
 <link href="atom.xml" rel="alternate" title="AlienZHOU's blog" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">AlienZHOU's blog</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; AlienZHOU's blog</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>PWA</label></li>

          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ" href="15354508213008.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(9)ç”Ÿäº§ç¯å¢ƒä¸­PWAå®è·µçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" href="15288038664515.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(9)ç”Ÿäº§ç¯å¢ƒä¸­PWAå®è·µçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(8)ä½¿ç”¨Service Workerè¿›è¡Œåå°åŒæ­¥ - Background Sync" href="15288038009038.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(8)ä½¿ç”¨Service Workerè¿›è¡Œåå°åŒæ­¥ - Background Sync</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(7)ä½¿ç”¨Notification APIæ¥è¿›è¡Œæ¶ˆæ¯æé†’" href="15288036503920.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(7)ä½¿ç”¨Notification APIæ¥è¿›è¡Œæ¶ˆæ¯æé†’</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(6) åœ¨Chromeä¸­è°ƒè¯•ä½ çš„PWA" href="15288035758780.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(6) åœ¨Chromeä¸­è°ƒè¯•ä½ çš„PWA</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(5)åœ¨Webä¸­è¿›è¡ŒæœåŠ¡ç«¯æ¶ˆæ¯æ¨é€" href="15288030176091.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(5)åœ¨Webä¸­è¿›è¡ŒæœåŠ¡ç«¯æ¶ˆæ¯æ¨é€</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(4) è§£å†³FireBase loginéªŒè¯å¤±è´¥é—®é¢˜" href="15235166926023.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(4) è§£å†³FireBase loginéªŒè¯å¤±è´¥é—®é¢˜</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(3) è®©ä½ çš„WebAppç¦»çº¿å¯ç”¨" href="15235151669706.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(3) è®©ä½ çš„WebAppç¦»çº¿å¯ç”¨</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(2) ä½¿ç”¨Manifestï¼Œè®©ä½ çš„WebAppæ›´â€œNativeâ€" href="15235140795593.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(2) ä½¿ç”¨Manifestï¼Œè®©ä½ çš„WebAppæ›´â€œNativeâ€</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(1) 2018ï¼Œå¼€å§‹ä½ çš„PWAå­¦ä¹ ä¹‹æ—…" href="15235138633619.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(1) 2018ï¼Œå¼€å§‹ä½ çš„PWAå­¦ä¹ ä¹‹æ—…</a></li>
          

      
        <li class="divider"></li>
        <li><label>React</label></li>

          
            <li><a title="åŸºäºreactæŠ€æœ¯æ ˆçš„å•é¡µåº”ç”¨(SPA)æ­å»º_å¿«é€Ÿå…¥é—¨å®è·µ" href="15236392559880.html">åŸºäºreactæŠ€æœ¯æ ˆçš„å•é¡µåº”ç”¨(SPA)æ­å»º_å¿«é€Ÿå…¥é—¨å®è·µ</a></li>
          
            <li><a title="åœ¨react-router4ä¸­è¿›è¡Œä»£ç æ‹†åˆ†ï¼ˆåŸºäºwebpackï¼‰" href="15235187668595.html">åœ¨react-router4ä¸­è¿›è¡Œä»£ç æ‹†åˆ†ï¼ˆåŸºäºwebpackï¼‰</a></li>
          

      
        <li class="divider"></li>
        <li><label>CSS</label></li>

          
            <li><a title="CSSå¸ƒå±€å­¦ä¹ æŒ‡å—[è¯‘]" href="15301745888974.html">CSSå¸ƒå±€å­¦ä¹ æŒ‡å—[è¯‘]</a></li>
          
            <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(3) ä½¿ç”¨ğŸ’…styled-componentsæ¥ä¼˜åŒ–reactç»„ä»¶å¼€å‘" href="15236398426783.html">ã€CSSæ¨¡å—åŒ–ã€‘(3) ä½¿ç”¨ğŸ’…styled-componentsæ¥ä¼˜åŒ–reactç»„ä»¶å¼€å‘</a></li>
          
            <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(2) BEMå‘½åæ–¹æ³•è®ºâ€”â€”ä½¿ç”¨BEM-constructoræ„å»ºCSS" href="15236396803035.html">ã€CSSæ¨¡å—åŒ–ã€‘(2) BEMå‘½åæ–¹æ³•è®ºâ€”â€”ä½¿ç”¨BEM-constructoræ„å»ºCSS</a></li>
          
            <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(1) webpackä¹‹Local Scope" href="15236395841604.html">ã€CSSæ¨¡å—åŒ–ã€‘(1) webpackä¹‹Local Scope</a></li>
          

      
        <li class="divider"></li>
        <li><label>Server</label></li>

          
            <li><a title="ã€MongoDBé«˜å¯ç”¨ã€‘å¤åˆ¶é›†Replica Setä½¿ç”¨ç®€ä»‹" href="15236400113573.html">ã€MongoDBé«˜å¯ç”¨ã€‘å¤åˆ¶é›†Replica Setä½¿ç”¨ç®€ä»‹</a></li>
          

      
        <li class="divider"></li>
        <li><label>Automation</label></li>

          
            <li><a title="Gulp.jså®è·µè¯¦è§£__åŸºäºGulpçš„å¤šé¡µé¢åº”ç”¨å®è·µæŒ‡å—" href="15236401468681.html">Gulp.jså®è·µè¯¦è§£__åŸºäºGulpçš„å¤šé¡µé¢åº”ç”¨å®è·µæŒ‡å—</a></li>
          

      
        <li class="divider"></li>
        <li><label>FE else</label></li>

          
            <li><a title="å„ç±»â€œæœåŠ¡å™¨æ¨â€æŠ€æœ¯åŸç†ä¸å®ä¾‹ï¼ˆPolling/COMET/SSE/WebSocketï¼‰" href="15288039493853.html">å„ç±»â€œæœåŠ¡å™¨æ¨â€æŠ€æœ¯åŸç†ä¸å®ä¾‹ï¼ˆPolling/COMET/SSE/WebSocketï¼‰</a></li>
          
            <li><a title="æµè§ˆå™¨åŒæºç­–ç•¥ä¸ajaxè·¨åŸŸæ–¹æ³•æ±‡æ€»" href="15236404711802.html">æµè§ˆå™¨åŒæºç­–ç•¥ä¸ajaxè·¨åŸŸæ–¹æ³•æ±‡æ€»</a></li>
          
            <li><a title="JavaScriptå¼‚æ­¥ç¼–ç¨‹__â€œå›è°ƒåœ°ç‹±â€çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ" href="15236403350295.html">JavaScriptå¼‚æ­¥ç¼–ç¨‹__â€œå›è°ƒåœ°ç‹±â€çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ</a></li>
          
            <li><a title="jsæ§åˆ¶inputæ¡†å†…å…‰æ ‡ä½ç½®ï¼ˆsetSelectionRangeè¯¦è§£ï¼‰" href="15236405992551.html">jsæ§åˆ¶inputæ¡†å†…å…‰æ ‡ä½ç½®ï¼ˆsetSelectionRangeè¯¦è§£ï¼‰</a></li>
          

      
        <li class="divider"></li>
        <li><label>Reading</label></li>

          
            <li><a title="æ¨èé˜…è¯» 2018.08" href="15333560595579.html">æ¨èé˜…è¯» 2018.08</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.07" href="15307688152882.html">æ¨èé˜…è¯» 2018.07</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.06" href="15288017709756.html">æ¨èé˜…è¯» 2018.06</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.05" href="15287963471356.html">æ¨èé˜…è¯» 2018.05</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.04" href="15283399559020.html">æ¨èé˜…è¯» 2018.04</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.03" href="15282529256902.html">æ¨èé˜…è¯» 2018.03</a></li>
          

      
        <li class="divider"></li>
        <li><label>Performace</label></li>

          
            <li><a title="ã€æ€§èƒ½ä¼˜åŒ–å®è·µã€‘ä¼˜åŒ–æ‰“åŒ…ç­–ç•¥æå‡é¡µé¢åŠ è½½é€Ÿåº¦" href="15288037747207.html">ã€æ€§èƒ½ä¼˜åŒ–å®è·µã€‘ä¼˜åŒ–æ‰“åŒ…ç­–ç•¥æå‡é¡µé¢åŠ è½½é€Ÿåº¦</a></li>
          

      
        <li class="divider"></li>
        <li><label>webpack</label></li>

          
            <li><a title="ã€webpackè¿›é˜¶ã€‘ä½¿ç”¨babelé¿å…webpackç¼–è¯‘è¿è¡Œæ—¶æ¨¡å—ä¾èµ–" href="15354509456422.html">ã€webpackè¿›é˜¶ã€‘ä½¿ç”¨babelé¿å…webpackç¼–è¯‘è¿è¡Œæ—¶æ¨¡å—ä¾èµ–</a></li>
          
            <li><a title="ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç°" href="15353386669734.html">ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç°</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>PWA</span></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ" href="15354508213008.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(9)ç”Ÿäº§ç¯å¢ƒä¸­PWAå®è·µçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" href="15288038664515.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(9)ç”Ÿäº§ç¯å¢ƒä¸­PWAå®è·µçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(8)ä½¿ç”¨Service Workerè¿›è¡Œåå°åŒæ­¥ - Background Sync" href="15288038009038.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(8)ä½¿ç”¨Service Workerè¿›è¡Œåå°åŒæ­¥ - Background Sync</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(7)ä½¿ç”¨Notification APIæ¥è¿›è¡Œæ¶ˆæ¯æé†’" href="15288036503920.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(7)ä½¿ç”¨Notification APIæ¥è¿›è¡Œæ¶ˆæ¯æé†’</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(6) åœ¨Chromeä¸­è°ƒè¯•ä½ çš„PWA" href="15288035758780.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(6) åœ¨Chromeä¸­è°ƒè¯•ä½ çš„PWA</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(5)åœ¨Webä¸­è¿›è¡ŒæœåŠ¡ç«¯æ¶ˆæ¯æ¨é€" href="15288030176091.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(5)åœ¨Webä¸­è¿›è¡ŒæœåŠ¡ç«¯æ¶ˆæ¯æ¨é€</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(4) è§£å†³FireBase loginéªŒè¯å¤±è´¥é—®é¢˜" href="15235166926023.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(4) è§£å†³FireBase loginéªŒè¯å¤±è´¥é—®é¢˜</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(3) è®©ä½ çš„WebAppç¦»çº¿å¯ç”¨" href="15235151669706.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(3) è®©ä½ çš„WebAppç¦»çº¿å¯ç”¨</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(2) ä½¿ç”¨Manifestï¼Œè®©ä½ çš„WebAppæ›´â€œNativeâ€" href="15235140795593.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(2) ä½¿ç”¨Manifestï¼Œè®©ä½ çš„WebAppæ›´â€œNativeâ€</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(1) 2018ï¼Œå¼€å§‹ä½ çš„PWAå­¦ä¹ ä¹‹æ—…" href="15235138633619.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(1) 2018ï¼Œå¼€å§‹ä½ çš„PWAå­¦ä¹ ä¹‹æ—…</a></li>
                        

                    
                      <li class="side-title"><span>React</span></li>
                        
                          <li><a title="åŸºäºreactæŠ€æœ¯æ ˆçš„å•é¡µåº”ç”¨(SPA)æ­å»º_å¿«é€Ÿå…¥é—¨å®è·µ" href="15236392559880.html">åŸºäºreactæŠ€æœ¯æ ˆçš„å•é¡µåº”ç”¨(SPA)æ­å»º_å¿«é€Ÿå…¥é—¨å®è·µ</a></li>
                        
                          <li><a title="åœ¨react-router4ä¸­è¿›è¡Œä»£ç æ‹†åˆ†ï¼ˆåŸºäºwebpackï¼‰" href="15235187668595.html">åœ¨react-router4ä¸­è¿›è¡Œä»£ç æ‹†åˆ†ï¼ˆåŸºäºwebpackï¼‰</a></li>
                        

                    
                      <li class="side-title"><span>CSS</span></li>
                        
                          <li><a title="CSSå¸ƒå±€å­¦ä¹ æŒ‡å—[è¯‘]" href="15301745888974.html">CSSå¸ƒå±€å­¦ä¹ æŒ‡å—[è¯‘]</a></li>
                        
                          <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(3) ä½¿ç”¨ğŸ’…styled-componentsæ¥ä¼˜åŒ–reactç»„ä»¶å¼€å‘" href="15236398426783.html">ã€CSSæ¨¡å—åŒ–ã€‘(3) ä½¿ç”¨ğŸ’…styled-componentsæ¥ä¼˜åŒ–reactç»„ä»¶å¼€å‘</a></li>
                        
                          <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(2) BEMå‘½åæ–¹æ³•è®ºâ€”â€”ä½¿ç”¨BEM-constructoræ„å»ºCSS" href="15236396803035.html">ã€CSSæ¨¡å—åŒ–ã€‘(2) BEMå‘½åæ–¹æ³•è®ºâ€”â€”ä½¿ç”¨BEM-constructoræ„å»ºCSS</a></li>
                        
                          <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(1) webpackä¹‹Local Scope" href="15236395841604.html">ã€CSSæ¨¡å—åŒ–ã€‘(1) webpackä¹‹Local Scope</a></li>
                        

                    
                      <li class="side-title"><span>Server</span></li>
                        
                          <li><a title="ã€MongoDBé«˜å¯ç”¨ã€‘å¤åˆ¶é›†Replica Setä½¿ç”¨ç®€ä»‹" href="15236400113573.html">ã€MongoDBé«˜å¯ç”¨ã€‘å¤åˆ¶é›†Replica Setä½¿ç”¨ç®€ä»‹</a></li>
                        

                    
                      <li class="side-title"><span>Automation</span></li>
                        
                          <li><a title="Gulp.jså®è·µè¯¦è§£__åŸºäºGulpçš„å¤šé¡µé¢åº”ç”¨å®è·µæŒ‡å—" href="15236401468681.html">Gulp.jså®è·µè¯¦è§£__åŸºäºGulpçš„å¤šé¡µé¢åº”ç”¨å®è·µæŒ‡å—</a></li>
                        

                    
                      <li class="side-title"><span>FE else</span></li>
                        
                          <li><a title="å„ç±»â€œæœåŠ¡å™¨æ¨â€æŠ€æœ¯åŸç†ä¸å®ä¾‹ï¼ˆPolling/COMET/SSE/WebSocketï¼‰" href="15288039493853.html">å„ç±»â€œæœåŠ¡å™¨æ¨â€æŠ€æœ¯åŸç†ä¸å®ä¾‹ï¼ˆPolling/COMET/SSE/WebSocketï¼‰</a></li>
                        
                          <li><a title="æµè§ˆå™¨åŒæºç­–ç•¥ä¸ajaxè·¨åŸŸæ–¹æ³•æ±‡æ€»" href="15236404711802.html">æµè§ˆå™¨åŒæºç­–ç•¥ä¸ajaxè·¨åŸŸæ–¹æ³•æ±‡æ€»</a></li>
                        
                          <li><a title="JavaScriptå¼‚æ­¥ç¼–ç¨‹__â€œå›è°ƒåœ°ç‹±â€çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ" href="15236403350295.html">JavaScriptå¼‚æ­¥ç¼–ç¨‹__â€œå›è°ƒåœ°ç‹±â€çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ</a></li>
                        
                          <li><a title="jsæ§åˆ¶inputæ¡†å†…å…‰æ ‡ä½ç½®ï¼ˆsetSelectionRangeè¯¦è§£ï¼‰" href="15236405992551.html">jsæ§åˆ¶inputæ¡†å†…å…‰æ ‡ä½ç½®ï¼ˆsetSelectionRangeè¯¦è§£ï¼‰</a></li>
                        

                    
                      <li class="side-title"><span>Reading</span></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.08" href="15333560595579.html">æ¨èé˜…è¯» 2018.08</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.07" href="15307688152882.html">æ¨èé˜…è¯» 2018.07</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.06" href="15288017709756.html">æ¨èé˜…è¯» 2018.06</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.05" href="15287963471356.html">æ¨èé˜…è¯» 2018.05</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.04" href="15283399559020.html">æ¨èé˜…è¯» 2018.04</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.03" href="15282529256902.html">æ¨èé˜…è¯» 2018.03</a></li>
                        

                    
                      <li class="side-title"><span>Performace</span></li>
                        
                          <li><a title="ã€æ€§èƒ½ä¼˜åŒ–å®è·µã€‘ä¼˜åŒ–æ‰“åŒ…ç­–ç•¥æå‡é¡µé¢åŠ è½½é€Ÿåº¦" href="15288037747207.html">ã€æ€§èƒ½ä¼˜åŒ–å®è·µã€‘ä¼˜åŒ–æ‰“åŒ…ç­–ç•¥æå‡é¡µé¢åŠ è½½é€Ÿåº¦</a></li>
                        

                    
                      <li class="side-title"><span>webpack</span></li>
                        
                          <li><a title="ã€webpackè¿›é˜¶ã€‘ä½¿ç”¨babelé¿å…webpackç¼–è¯‘è¿è¡Œæ—¶æ¨¡å—ä¾èµ–" href="15354509456422.html">ã€webpackè¿›é˜¶ã€‘ä½¿ç”¨babelé¿å…webpackç¼–è¯‘è¿è¡Œæ—¶æ¨¡å—ä¾èµ–</a></li>
                        
                          <li><a title="ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç°" href="15353386669734.html">ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç°</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 <div class="markdown-body">
<h1>ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç°</h1>

<blockquote>
<p>ä½ çœŸçš„äº†è§£å‰ç«¯æ¨¡å—åŒ–ä¹ˆï¼Ÿ</p>
</blockquote>

<h2 id="toc_0">å‘Šåˆ«ã€Œwebpacké…ç½®å·¥ç¨‹å¸ˆã€</h2>

<p>webpackæ˜¯ä¸€ä¸ªå¼ºå¤§è€Œå¤æ‚çš„å‰ç«¯è‡ªåŠ¨åŒ–å·¥å…·ã€‚å…¶ä¸­ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯é…ç½®å¤æ‚ï¼Œè¿™ä¹Ÿä½¿å¾—ã€Œwebpacké…ç½®å·¥ç¨‹å¸ˆã€è¿™ç§æˆè°‘çš„ç§°å‘¼å¼€å§‹æµè¡ŒğŸ¤·ä½†æ˜¯ï¼Œéš¾é“ä½ çœŸçš„åªæ»¡è¶³äºç©è½¬webpacké…ç½®ä¹ˆï¼Ÿ</p>

<p>æ˜¾ç„¶ä¸æ˜¯ã€‚åœ¨å­¦ä¹ å¦‚ä½•ä½¿ç”¨webpackä¹‹å¤–ï¼Œæˆ‘ä»¬æ›´éœ€è¦æ·±å…¥webpackå†…éƒ¨ï¼Œæ¢ç´¢å„éƒ¨åˆ†çš„è®¾è®¡ä¸å®ç°ã€‚ä¸‡å˜ä¸ç¦»å…¶å®—ï¼Œå³ä½¿æœ‰ä¸€å¤©webpackâ€œè¿‡æ°”â€äº†ï¼Œä½†å®ƒçš„æŸäº›è®¾è®¡ä¸å®ç°å´ä»ä¼šæœ‰å­¦ä¹ ä»·å€¼ä¸å€Ÿé‰´æ„ä¹‰ã€‚å› æ­¤ï¼Œåœ¨å­¦ä¹ webpackè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¼šæ€»ç»“ä¸€ç³»åˆ—ã€webpackè¿›é˜¶ã€‘çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«ã€‚</p>

<p>æ¬¢è¿æ„Ÿå…´è¶£çš„åŒå­¦å¤šå¤šäº¤æµä¸å…³æ³¨ï¼</p>

<h2 id="toc_1">1. å¼•è¨€</h2>

<p>ä¸‹é¢è¿›å…¥æ­£é¢˜ã€‚ä¸€ç›´ä»¥æ¥ï¼Œåœ¨å‰ç«¯é¢†åŸŸï¼Œå¼€å‘äººå‘˜æ—¥ç›Šå¢é•¿çš„è¯­è¨€èƒ½åŠ›éœ€æ±‚å’Œè½åçš„JavaScriptè§„èŒƒå½¢æˆäº†ä¸€å¤§çŸ›ç›¾ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¼šç”¨babelæ¥è¿›è¡ŒES6åˆ°ES5çš„è¯­æ³•è½¬æ¢ï¼Œä¼šä½¿ç”¨å„ç§polyfillæ¥å…¼å®¹è€å¼ä¸Šçš„æ–°ç‰¹æ€§â€¦â€¦è€Œæˆ‘ä»¬æœ¬æ–‡çš„ä¸»è§’ â€”â€” æ¨¡å—åŒ–ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>

<p>ç”±äºJavaScriptåœ¨è®¾è®¡ä¹‹åˆå°±æ²¡æœ‰è€ƒè™‘è¿™ä¸€ç‚¹ï¼ŒåŠ ä¹‹æ¨¡å—åŒ–è§„èŒƒçš„è¿Ÿåˆ°ï¼Œå¯¼è‡´ç¤¾åŒºä¸­æ¶Œç°å‡ºä¸€ç³»åˆ—å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–æ–¹æ¡ˆï¼Œä¾‹å¦‚RequireJSã€seaJSç­‰ã€‚ä»¥åŠä¸ä¹‹å¯¹åº”çš„ç¼–è¯‘æœŸæ¨¡å—ä¾èµ–è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚browserifyã€rollupå’Œæœ¬æ–‡çš„ä¸»è§’webpackã€‚</p>

<p>ä½†æ˜¯æˆ‘ä»¬è¦çŸ¥é“ï¼Œ<code>&lt;script type=&quot;module&quot;&gt;</code>è¿˜å­˜åœ¨ä¸€å®šçš„å…¼å®¹æ€§ä¸ä½¿ç”¨é—®é¢˜ã€‚</p>

<p><img src="https://user-gold-cdn.xitu.io/2018/8/27/1657be864c854472?w=2348&amp;h=1252&amp;f=png&amp;s=273693" alt=""/></p>

<p>åœ¨æ›´é€šç”¨çš„èŒƒå›´å†…æ¥è®²ï¼Œæµè§ˆå™¨åŸç”Ÿå®é™…æ˜¯ä¸æ”¯æŒæ‰€è°“çš„CommonJSæˆ–ESMæ¨¡å—åŒ–è§„èŒƒçš„ã€‚é‚£ä¹ˆwebpackæ˜¯å¦‚ä½•åœ¨æ‰“åŒ…å‡ºçš„ä»£ç ä¸­å®ç°æ¨¡å—åŒ–çš„å‘¢ï¼Ÿ</p>

<h2 id="toc_2">2. NodeJSä¸­çš„æ¨¡å—åŒ–</h2>

<p>åœ¨æ¢ç©¶webpackæ‰“åŒ…åä»£ç çš„æ¨¡å—åŒ–å®ç°å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹Nodeä¸­çš„æ¨¡å—åŒ–ã€‚</p>

<p>NodeJSï¼ˆä»¥ä¸‹ç®€ç§°ä¸ºNodeï¼‰åœ¨æ¨¡å—åŒ–ä¸ŠåŸºæœ¬æ˜¯éµå¾ªçš„CommonJSè§„èŒƒï¼Œè€Œwebpackæ‰“åŒ…å‡ºæ¥çš„ä»£ç æ‰€å®ç°æ¨¡å—åŒ–çš„æ–¹å¼ï¼Œä¹Ÿç±»ä¼¼äºCommonJSã€‚å› æ­¤ï¼Œæˆ‘ä»¬å…ˆä»¥ç†Ÿæ‚‰çš„Nodeï¼ˆè¿™é‡Œä¸»è¦å‚è€ƒNode v10ï¼‰ä½œä¸ºå¼•å­ï¼Œç®€å•ä»‹ç»å®ƒçš„æ¨¡å—åŒ–å®ç°ï¼Œå¸®åŠ©æˆ‘ä»¬æ¥ä¸‹æ¥ç†è§£webpackçš„å®ç°ã€‚</p>

<p>Nodeä¸­çš„æ¨¡å—å¼•å…¥ä¼šç»å†ä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š</p>

<ol>
<li>è·¯å¾„åˆ†æ</li>
<li>æ–‡ä»¶å®šä½</li>
<li>ç¼–è¯‘æ‰§è¡Œ</li>
</ol>

<p>åœ¨Nodeä¸­ï¼Œæ¨¡å—ä»¥æ–‡ä»¶ç»´åº¦å­˜åœ¨ï¼Œå¹¶ä¸”åœ¨ç¼–è¯‘åç¼“å­˜äºå†…å­˜ä¸­ï¼Œé€šè¿‡<code>require.cache</code>å¯ä»¥æŸ¥çœ‹æ¨¡å—ç¼“å­˜æƒ…å†µã€‚åœ¨æ¨¡å—ä¸­æ·»åŠ <code>console.log(require.cache)</code>æŸ¥çœ‹è¾“å‡ºå¦‚ä¸‹ï¼š</p>

<pre><code class="language-JavaScript">{ &#39;/Users/alienzhou/programming/gitrepo/test.js&#39;:
   Module {
     id: &#39;.&#39;,
     exports: {},
     parent: null,
     filename: &#39;/Users/alienzhou/programming/gitrepo/test.js&#39;,
     loaded: false,
     children: [],
     paths:
      [ &#39;/Users/alienzhou/programming/gitrepo/node_modules&#39;,
        &#39;/Users/alienzhou/programming/node_modules&#39;,
        &#39;/Users/alienzhou/node_modules&#39;,
        &#39;/Users/node_modules&#39;,
        &#39;/node_modules&#39; ] } }
</code></pre>

<p>ä¸Šé¢å°±æ˜¯æ¨¡å—å¯¹è±¡çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå¯ä»¥åœ¨<a href="https://github.com/nodejs/node/blob/master/lib/internal/modules/cjs/loader.js#L102-L110">Nodeæºç </a>ä¸­æ‰¾åˆ°Moduleç±»çš„æ„é€ æ–¹æ³•ã€‚å…¶ä¸­<code>exports</code>å±æ€§éå¸¸é‡è¦ï¼Œå®ƒå°±æ˜¯æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡ã€‚å› æ­¤ï¼Œä¸‹é¢è¿™è¡Œè¯­å¥</p>

<pre><code class="language-JavaScript">var test = require(&#39;./test.js&#39;);
</code></pre>

<p>å…¶å®å°±æ˜¯æŠŠ<code>test.js</code>æ¨¡å—çš„<code>exports</code>å±æ€§èµ‹å€¼ç»™<code>test</code>å˜é‡ã€‚</p>

<p>ä¹Ÿè®¸ä½ è¿˜ä¼šå¥½å¥‡ï¼Œå½“æˆ‘ä»¬å†™ä¸€ä¸ªNode(JavaScript)æ¨¡å—æ—¶ï¼Œæ¨¡å—é‡Œçš„<code>module</code>ã€<code>require</code>ã€<code>__filename</code>ç­‰è¿™äº›å˜é‡æ˜¯å“ªæ¥çš„ï¼Ÿå¦‚æœä½ çœ‹è¿‡<a href="https://github.com/nodejs/node/blob/master/lib/internal/modules/cjs/loader.js#L124-L131">Node loader.js éƒ¨åˆ†æºç </a>ï¼Œåº”è¯¥å°±å¤§è‡´èƒ½ç†è§£ï¼š</p>

<pre><code class="language-JavaScript">Module.wrap = function(script) {
  return Module.wrapper[0] + script + Module.wrapper[1];
};

Module.wrapper = [
  &#39;(function (exports, require, module, __filename, __dirname) { &#39;,
  &#39;\n});&#39;
];
</code></pre>

<p>Nodeä¼šè‡ªåŠ¨å°†æ¯ä¸ªæ¨¡å—è¿›è¡ŒåŒ…è£…ï¼ˆwrapï¼‰ï¼Œå°†å…¶å˜ä¸ºä¸€ä¸ªfunctionã€‚ä¾‹å¦‚æ¨¡å—test.jsåŸæœ¬ä¸ºï¼š</p>

<pre><code class="language-JavaScript">console.log(require.cache);
module.exports = &#39;test&#39;;
</code></pre>

<p>åŒ…è£…åå¤§è‡´ä¼šå˜ä¸ºï¼š</p>

<pre><code class="language-JavaScript">(function (exports, require, module, __filename, __dirname) {
    console.log(require.cache);
    module.exports = &#39;test&#39;;
});
</code></pre>

<p>è¿™ä¸‹ä½ åº”è¯¥æ˜ç™½<code>module</code>ã€<code>require</code>ã€<code>__filename</code>è¿™äº›å˜é‡éƒ½æ˜¯å“ªæ¥çš„äº†å§ â€”â€” å®ƒä»¬ä¼šè¢«ä½œä¸ºfunctionçš„å‚æ•°åœ¨æ¨¡å—ç¼–è¯‘æ‰§è¡Œæ—¶æ³¨å…¥è¿›æ¥ã€‚ä»¥ä¸€ä¸ªæ‰©å±•åä¸º<code>.js</code>çš„æ¨¡å—ä¸ºä¾‹ï¼Œå½“ä½ <code>require</code>å®ƒæ—¶ï¼Œä¸€ä¸ªå®Œæ•´çš„æ–¹æ³•è°ƒç”¨å¤§è‡´åŒ…æ‹¬ä¸‹é¢å‡ ä¸ªè¿‡ç¨‹ï¼š</p>

<pre><code class="language-flow">st=&gt;start: require()å¼•å…¥æ¨¡å—
op1=&gt;operation: è°ƒç”¨._load()åŠ è½½æ¨¡å—
op2=&gt;operation: new Module(filename, parent)åˆ›å»ºæ¨¡å—å¯¹è±¡
op3=&gt;operation: å°†æ¨¡å—å¯¹è±¡å­˜å…¥ç¼“å­˜
op4=&gt;operation: æ ¹æ®æ–‡ä»¶ç±»å‹è°ƒç”¨Module._extensions
op5=&gt;operation: è°ƒç”¨.compile()ç¼–è¯‘æ‰§è¡Œjsæ¨¡å—
cond=&gt;condition: Module._cacheæ˜¯å¦æ— ç¼“å­˜
e=&gt;end: è¿”å›module.exportsç»“æœ
st-&gt;op1-&gt;cond
cond(yes)-&gt;op2-&gt;op3-&gt;op4-&gt;op5-&gt;e
cond(no)-&gt;e
</code></pre>

<p>åœ¨<a href="https://github.com/nodejs/node/blob/master/lib/internal/modules/cjs/loader.js#L685-L691">Nodeæºç </a>ä¸­èƒ½çœ‹åˆ°ï¼Œæ¨¡å—æ‰§è¡Œæ—¶ï¼ŒåŒ…è£…å®šä¹‰çš„å‡ ä¸ªå˜é‡è¢«æ³¨å…¥äº†ï¼š</p>

<pre><code class="language-JavaScript">if (inspectorWrapper) {
    result = inspectorWrapper(compiledWrapper, this.exports, this.exports,
                              require, this, filename, dirname);

} else {
    result = compiledWrapper.call(this.exports, this.exports, require, this,
                                  filename, dirname);
}

</code></pre>

<blockquote>
<p>é¢˜å¤–è¯ï¼Œä»è¿™é‡Œä½ ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œåœ¨æ¨¡å—å†…ä½¿ç”¨<code>module.exports</code>ä¸<code>exports</code>çš„åŒºåˆ«</p>
</blockquote>

<h2 id="toc_3">3. webpackå®ç°çš„å‰ç«¯æ¨¡å—åŒ–</h2>

<p>ä¹‹æ‰€ä»¥åœ¨ä»‹ç»ã€Œwebpackæ˜¯å¦‚ä½•åœ¨æ‰“åŒ…å‡ºçš„ä»£ç ä¸­å®ç°æ¨¡å—åŒ–ã€ä¹‹å‰ï¼Œå…ˆç”¨ä¸€å®šç¯‡å¹…ä»‹ç»äº†Nodeä¸­çš„æ¨¡å—åŒ–ï¼Œæ˜¯å› ä¸ºä¸¤è€…åœ¨åŒæ­¥ä¾èµ–çš„è®¾è®¡ä¸å®ç°ä¸Šæœ‰å¼‚æ›²åŒå·¥ä¹‹å¤„ã€‚ç†è§£Nodeçš„æ¨¡å—åŒ–å¯¹å­¦ä¹ webpackå¾ˆæœ‰å¸®åŠ©ã€‚å½“ç„¶ï¼Œç”±äºè¿è¡Œç¯å¢ƒçš„ä¸åŒï¼ˆwebpackæ‰“åŒ…å‡ºçš„ä»£ç è¿è¡Œåœ¨å®¢æˆ·ç«¯ï¼Œè€ŒNodeæ˜¯åœ¨æœåŠ¡ç«¯ï¼‰ï¼Œå®ç°ä¸Šä¹Ÿæœ‰ä¸€å®šçš„å·®å¼‚ã€‚</p>

<p>ä¸‹é¢å°±æ¥çœ‹ä¸€ä¸‹ï¼Œwebpackæ˜¯å¦‚ä½•åœ¨æ‰“åŒ…å‡ºçš„ä»£ç ä¸­å®ç°å‰ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰æ¨¡å—åŒ–çš„ã€‚</p>

<h3 id="toc_4">3.1. æ¨¡å—å¯¹è±¡</h3>

<p>å’ŒNodeçš„æ¨¡å—åŒ–å®ç°ç±»ä¼¼ï¼Œåœ¨webpackæ‰“åŒ…å‡ºçš„ä»£ç ä¸­ï¼Œæ¯ä¸ªæ¨¡å—ä¹Ÿæœ‰ä¸€ä¸ªå¯¹åº”çš„æ¨¡å—å¯¹è±¡ã€‚åœ¨<code>__webpack_require__()</code>æ–¹æ³•ä¸­ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼š</p>

<pre><code class="language-javascript">function __webpack_require__(moduleId) {
    // â€¦â€¦ other code
    
    var module = installedModules[moduleId] = {
        i: moduleId,
        l: false,
        exports: {},
        parents: null,
        children: []
    };
    
    // â€¦â€¦ other code
}
</code></pre>

<p>ç±»ä¼¼äºNodeï¼Œåœ¨webpackä¸­å„ä¸ªæ¨¡å—çš„ä¹Ÿæœ‰å¯¹åº”çš„æ¨¡å—å¯¹è±¡ï¼Œå…¶æ•°æ®ç»“æ„åŸºæœ¬éµå¾ªCommonJSè§„èŒƒï¼›å…¶ä¸­<code>installedModules</code>åˆ™æ˜¯æ¨¡å—ç¼“å­˜å¯¹è±¡ï¼Œç±»ä¼¼äºNodeä¸­çš„<code>require.cache</code>/<code>Module._cache</code>ã€‚</p>

<h3 id="toc_5">2.2. æ¨¡å—çš„requireï¼š<code>__webpack_require__</code></h3>

<p><code>__webpack_require__</code>æ˜¯webpackå‰ç«¯è¿è¡Œæ—¶æ¨¡å—åŒ–ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç›¸å½“äºCommonJSè§„èŒƒä¸­çš„<code>require</code>ã€‚</p>

<p>æ ¹æ®ç¬¬ä¸€éƒ¨åˆ†çš„æµç¨‹å›¾ï¼šåœ¨Nodeä¸­ï¼Œå½“æˆ‘ä»¬<code>require</code>ä¸€ä¸ªæ¨¡å—æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­è¯¥æ¨¡å—æ˜¯å¦åœ¨ç¼“å­˜ä¹‹ä¸­ï¼Œå¦‚æœå­˜åœ¨åˆ™ç›´æ¥è¿”å›è¯¥æ¨¡å—çš„<code>exports</code>å±æ€§ï¼›å¦åˆ™ä¼šåŠ è½½å¹¶æ‰§è¡Œè¯¥æ¨¡å—ã€‚webpackä¸­çš„å®ç°ä¹Ÿç±»ä¼¼ï¼š</p>

<pre><code class="language-javascript">function __webpack_require__(moduleId) {
    // 1.é¦–å…ˆä¼šæ£€æŸ¥æ¨¡å—ç¼“å­˜
    if(installedModules[moduleId]) {
        return installedModules[moduleId].exports;
    }
    
    // 2. ç¼“å­˜ä¸å­˜åœ¨æ—¶ï¼Œåˆ›å»ºå¹¶ç¼“å­˜ä¸€ä¸ªæ–°çš„æ¨¡å—å¯¹è±¡ï¼Œç±»ä¼¼Nodeä¸­çš„new Moduleæ“ä½œ
    var module = installedModules[moduleId] = {
        i: moduleId,
        l: false,
        exports: {},
        children: []
    };

    // 3. æ‰§è¡Œæ¨¡å—ï¼Œç±»ä¼¼äºNodeä¸­çš„ï¼š
    // result = compiledWrapper.call(this.exports, this.exports, require, this, filename, dirname);
    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

    module.l = true;

    // 4. è¿”å›è¯¥moduleçš„è¾“å‡º
    return module.exports;
}
</code></pre>

<p>å¦‚æœä½ ä»”ç»†å¯¹æ¯”webpackä¸Nodeï¼Œä½ ä¼šå‘ç°åœ¨<code>__webpack_require__</code>ä¸­æœ‰ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ï¼š</p>

<p>åœ¨webpackä¸­ä¸å­˜åœ¨åƒNodeä¸€æ ·è°ƒç”¨<code>._compile()</code>è¿™ç§æ–¹æ³•çš„è¿‡ç¨‹ã€‚å³ä¸ä¼šåƒNodeé‚£æ ·ï¼Œå¯¹ä¸€ä¸ªæœªè½½å…¥ç¼“å­˜çš„æ¨¡å—ï¼Œé€šè¿‡ã€Œè¯»å–æ¨¡å—è·¯å¾„ -&gt; ç¼–è¯‘æ¨¡å—ä»£ç  -&gt; æ‰§è¡Œæ¨¡å—ã€æ¥è½½å…¥æ¨¡å—ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>

<p>è¿™æ˜¯å› ä¸ºï¼ŒNodeä½œä¸ºæœåŠ¡ç«¯è¯­è¨€ï¼Œæ¨¡å—éƒ½æ˜¯æœ¬åœ°æ–‡ä»¶ï¼ŒåŠ è½½æ—¶å»¶ä½ï¼Œå¯åŒæ­¥é˜»å¡è¿›è¡Œæ¨¡å—æ–‡ä»¶å¯»å€ã€è¯»å–ã€ç¼–è¯‘å’Œæ‰§è¡Œï¼Œè¿™äº›è¿‡ç¨‹åœ¨æ¨¡å—requireçš„æ—¶å€™å†â€œæŒ‰éœ€â€æ‰§è¡Œå³å¯ï¼›è€Œwebpackè¿è¡Œåœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ï¼Œæ˜¾ç„¶ä¸èƒ½åœ¨éœ€è¦æ—¶ï¼ˆå³æ‰§è¡Œ<code>__webpack_require__</code>æ—¶ï¼‰å†é€šè¿‡ç½‘ç»œåŠ è½½jsæ–‡ä»¶ï¼Œå¹¶åŒæ­¥åœ°ç­‰å¾…åŠ è½½å®Œæˆåå†è¿”å›<code>__webpack_require__</code>ã€‚è¿™ç§ç½‘ç»œæ—¶å»¶ï¼Œæ˜¾ç„¶ä¸èƒ½æ»¡è¶³â€œåŒæ­¥ä¾èµ–â€çš„è¦æ±‚ã€‚</p>

<p>é‚£ä¹ˆwebpackæ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜çš„å‘¢ï¼Ÿ</p>

<h3 id="toc_6">3.2. å¦‚ä½•è§£å†³å‰ç«¯çš„åŒæ­¥ä¾èµ–</h3>

<p>æˆ‘ä»¬è¿˜æ˜¯å›æ¥çœ‹ä¸‹Nodeï¼š</p>

<p>Nodeï¼ˆv10ï¼‰ä¸­åŠ è½½ã€ç¼–è¯‘ä¸æ‰§è¡Œï¼ˆjsï¼‰æ¨¡å—çš„ä»£ç ä¸»è¦é›†ä¸­åœ¨<code>Module._extensions[&#39;.js&#39;]</code>å’Œ<code>Module.prototype._compile</code>ä¸­ã€‚é¦–å…ˆä¼šé€šè¿‡<code>fs.readFileSync</code>è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç„¶åé€šè¿‡<code>vm.runInThisContext</code>æ¥ç¼–è¯‘å’Œæ‰§è¡ŒJavaScriptä»£ç ã€‚</p>

<blockquote>
<p>The vm module provides APIs for compiling and running code within V8 Virtual Machine contexts.</p>
</blockquote>

<p>ä½†æ˜¯ï¼Œæ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œåœ¨å‰ç«¯runtimeä¸­è‚¯å®šä¸èƒ½é€šè¿‡ç½‘ç»œå»åŒæ­¥è·å–JavaScriptè„šæœ¬æ–‡ä»¶ï¼›é‚£ä¹ˆå°±éœ€è¦æˆ‘ä»¬æ¢ä¸€ä¸ªæ€è·¯ï¼šæœ‰æ²¡æœ‰ä»€ä¹ˆåœ°æ–¹èƒ½å¤Ÿé¢„å…ˆæ”¾ç½®æˆ‘ä»¬â€œä¹‹åâ€å¯èƒ½ä¼šéœ€è¦çš„æ¨¡å—ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨requireæ—¶ä¸éœ€è¦åŒæ­¥ç­‰å¾…è¿‡é•¿çš„æ—¶é—´ï¼ˆå½“ç„¶ï¼Œè¿™é‡Œçš„â€œä¹‹åâ€å¯èƒ½æ˜¯å‡ ç§’ã€å‡ åˆ†é’Ÿåï¼Œä¹Ÿå¯èƒ½æ˜¯è¿™æ¬¡äº‹ä»¶å¾ªç¯taskçš„ä¸‹å‡ è¡Œä»£ç ï¼‰ã€‚</p>

<p>å†…å­˜å°±æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚æˆ‘ä»¬å¯ä»¥æŠŠåŒæ­¥ä¾èµ–çš„æ¨¡å—å…ˆâ€œæ³¨å†Œâ€åˆ°å†…å­˜ä¸­ï¼ˆæ¨¡å—æš‚å­˜ï¼‰ï¼Œç­‰åˆ°requireæ—¶ï¼Œå†æ‰§è¡Œè¯¥æ¨¡å—ã€ç¼“å­˜æ¨¡å—å¯¹è±¡ã€è¿”å›å¯¹åº”çš„<code>exports</code>ã€‚è€Œwebpackä¸­ï¼Œè¿™ä¸ªæ‰€è°“çš„å†…å­˜å°±æ˜¯<code>modules</code>å¯¹è±¡ã€‚</p>

<blockquote>
<p>æ³¨æ„è¿™é‡ŒæŒ‡çš„æ¨¡å—æš‚å­˜å’Œæ¨¡å—ç¼“å­˜æ¦‚å¿µå®Œå…¨ä¸åŒã€‚æš‚å­˜å¯ä»¥ç²—ç•¥ç±»æ¯”ä¸ºå°†ç¼–è¯‘å¥½çš„æ¨¡å—ä»£ç å…ˆæ”¾åˆ°å†…å­˜ä¸­ï¼Œå®é™…å¹¶æ²¡æœ‰å¼•å…¥è¯¥æ¨¡å—ã€‚åŸºäºè¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠâ€œæ¨¡å—æš‚å­˜â€ç†è§£ä¸ºâ€œæ¨¡å—æ³¨å†Œâ€ï¼Œå› æ­¤åæ–‡ä¸­â€œæ¨¡å—æš‚å­˜â€ä¸â€œæ¨¡å—æ³¨å†Œâ€å…·æœ‰ç›¸ç­‰çš„æ¦‚å¿µã€‚</p>
</blockquote>

<p>æ‰€ä»¥ï¼Œè¿‡ç¨‹å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š</p>

<p>å½“æˆ‘ä»¬å·²ç»è·å–äº†æ¨¡å—å†…å®¹åï¼ˆä½†æ¨¡å—è¿˜æœªæ‰§è¡Œï¼‰ï¼Œæˆ‘ä»¬å°±å°†å…¶æš‚å­˜åœ¨<code>modules</code>å¯¹è±¡ä¸­ï¼Œé”®å°±æ˜¯webpackçš„moduleIdï¼›ç­‰åˆ°éœ€è¦ä½¿ç”¨<code>__webpack_require__</code>å¼•ç”¨æ¨¡å—æ—¶ï¼Œå‘ç°ç¼“å­˜ä¸­æ²¡æœ‰ï¼Œåˆ™ä»<code>modules</code>å¯¹è±¡ä¸­å–å‡ºæš‚å­˜çš„æ¨¡å—å¹¶æ‰§è¡Œã€‚</p>

<h3 id="toc_7">3.3. å¦‚ä½•â€æš‚å­˜â€œæ¨¡å—</h3>

<p>æ€è·¯å·²ç»æ¸…æ™°äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ¥çœ‹çœ‹ï¼Œwebpackæ˜¯å¦‚ä½•å°†æ¨¡å—â€œæš‚å­˜â€åœ¨<code>modules</code>å¯¹è±¡ä¸Šçš„ã€‚åœ¨å®é™…ä¸Šï¼Œwebpackæ‰“åŒ…å‡ºæ¥çš„ä»£ç å¯ä»¥ç®€å•åˆ†ä¸ºä¸¤ç±»ï¼š</p>

<ul>
<li>ä¸€ç±»æ˜¯webpackæ¨¡å—åŒ–çš„å‰ç«¯runtimeï¼Œä½ å¯ä»¥ç®€å•ç±»æ¯”ä¸ºRequireJSè¿™æ ·çš„å‰ç«¯æ¨¡å—åŒ–ç±»åº“æ‰€å®ç°çš„åŠŸèƒ½ã€‚å®ƒä¼šæ§åˆ¶æ¨¡å—çš„åŠ è½½ã€ç¼“å­˜ï¼Œæä¾›è¯¸å¦‚<code>__webpack_require__</code>è¿™æ ·çš„requireæ–¹æ³•ç­‰ã€‚</li>
<li>å¦ä¸€ç±»åˆ™æ˜¯æ¨¡å—æ³¨å†Œä¸è¿è¡Œçš„ä»£ç ï¼ŒåŒ…å«äº†æºç ä¸­çš„æ¨¡å—ä»£ç ã€‚ä¸ºäº†è¿›ä¸€æ­¥ç†è§£ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è¿™éƒ¨åˆ†çš„ä»£ç æ˜¯æ€æ ·çš„ã€‚</li>
</ul>

<blockquote>
<p>ä¸ºäº†ä¾¿äºå­¦ä¹ ä¸ä»£ç é˜…è¯»ï¼Œå»ºè®®ä½ å¯ä»¥åœ¨webpackï¼ˆv4ï¼‰é…ç½®ä¸­åŠ å…¥<code>optimization:{runtimeChunk: {name: &#39;runtime&#39;}}</code>ï¼Œè¿™æ ·ä¼šè®©webpackå°†runtimeä¸æ¨¡å—æ³¨å†Œä»£ç åˆ†å¼€æ‰“åŒ…ã€‚</p>
</blockquote>

<pre><code class="language-JavaScript">// webpack module chunk
(window[&quot;webpackJsonp&quot;] = window[&quot;webpackJsonp&quot;] || []).push([[&quot;home-0&quot;],{

/***/ &quot;module-home-0&quot;:
/***/ (function(module, exports, __webpack_require__) {

const myalert = __webpack_require__(&quot;module-home-1&quot;);

myalert(&#39;test&#39;);

/***/ }),

/***/ &quot;module-home-1&quot;:
/***/ (function(module, exports) {

module.exports = function (a) {
    alert(&#39;hi:&#39; + a);
};

/***/ })

},[[&quot;module-home-0&quot;,&quot;home-1&quot;]]]);
</code></pre>

<p>ä¸Šé¢è¿™æ˜¯ä¸€ä¸ªä¸åŒ…å«runtimeçš„chunkï¼Œæˆ‘ä»¬ä¸å¦¨å°†å…¶ç§°ä¸ºmodule chunkï¼ˆä¸‹é¢ä¼šæ²¿ç”¨è¿™ä¸ªå«æ³•ï¼‰ã€‚ç®€åŒ–ä¸€ä¸‹è¿™éƒ¨åˆ†ä»£ç ï¼Œå¤§è‡´ç»“æ„å¦‚ä¸‹ï¼š</p>

<pre><code class="language-JavaScript">// webpack module chunk
window[&quot;webpackJsonp&quot;].push([
    [&quot;home-0&quot;], // chunkIds
    {
        &quot;module-home-0&quot;: (function(module, exports, __webpack_require__){ /* some logic */ }),
        &quot;module-home-1&quot;: (function(module, exports, __webpack_require__){ /* some logic */ })
    },
    [[&quot;module-home-0&quot;,&quot;home-1&quot;]]
])
</code></pre>

<p>è¿™é‡Œï¼Œ<code>.push()</code>æ–¹æ³•å‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ä¸‰ä¸ªå…ƒç´ ï¼š</p>

<ul>
<li>ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ<code>[&quot;home-0&quot;]</code>è¡¨ç¤ºè¯¥jsæ–‡ä»¶æ‰€åŒ…å«çš„æ‰€æœ‰chunkçš„idï¼ˆå¯ä»¥ç²—ç•¥ç†è§£ä¸ºï¼Œwebpackä¸­moduleç»„æˆchunkï¼Œchunkåˆç»„æˆfileï¼‰ï¼›</li>
<li>ç¬¬äºŒä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé”®æ˜¯å„ä¸ªæ¨¡å—çš„idï¼Œå€¼åˆ™æ˜¯ä¸€ä¸ªè¢«functionåŒ…è£…åçš„æ¨¡å—ï¼›</li>
<li>ç¬¬ä¸‰ä¸ªå…ƒç´ ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶åˆæ˜¯ç”±å¤šä¸ªæ•°ç»„ç»„æˆã€‚å…·ä½“ä½œç”¨æˆ‘ä»¬å…ˆæŒ‰ä¸‹ä¸è¡¨ï¼Œæœ€åå†è¯´ã€‚</li>
</ul>

<p>æ¥çœ‹ä¸‹å‚æ•°æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´  â€”â€” åŒ…å«æ¨¡å—ä»£ç çš„å¯¹è±¡ï¼Œä½ ä¼šå‘ç°è¿™é‡Œæ–¹æ³•ç­¾åæ˜¯ä¸æ˜¯å¾ˆåƒNodeä¸­çš„é€šè¿‡<code>Module.wrap()</code>è¿›è¡Œçš„æ¨¡å—ä»£ç åŒ…è£…ï¼Ÿæ²¡é”™ï¼Œ<a href="https://github.com/webpack/webpack/blob/master/lib/FunctionModuleTemplatePlugin.js#L16-L31">webpackæºç </a>ä¸­ä¹Ÿæœ‰ç±»ä¼¼ï¼Œä¼šåƒNodeé‚£æ ·ï¼Œå°†æ¯ä¸ªæ¨¡å—çš„ä»£ç ç”¨ä¸€ä¸ªfunctionåŒ…è£…èµ·æ¥ã€‚</p>

<p>è€Œå½“webpacké…ç½®äº†runtimeåˆ†ç¦»åï¼Œæ‰“åŒ…å‡ºçš„æ–‡ä»¶ä¸­ä¼šå‡ºç°ä¸€ä¸ªâ€œçº¯å‡€â€çš„ã€ä¸åŒ…å«ä»»ä½•æ¨¡å—ä»£ç çš„runtimeï¼Œå…¶ä¸»è¦æ˜¯ä¸€ä¸ªè‡ªæ‰§è¡Œæ–¹æ³•ï¼Œå…¶ä¸­æš´éœ²äº†ä¸€ä¸ªå…¨å±€å˜é‡<code>webpackJsonp</code>ï¼š</p>

<pre><code class="language-JavaScript">// webpack runtime chunk
var jsonpArray = window[&quot;webpackJsonp&quot;] = window[&quot;webpackJsonp&quot;] || [];
var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
jsonpArray.push = webpackJsonpCallback;
</code></pre>

<blockquote>
<p><code>webpackJsonp</code>å˜é‡åå¯ä»¥é€šè¿‡<code>output.jsonpFunction</code>è¿›è¡Œé…ç½®</p>
</blockquote>

<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>window[&quot;webpackJsonp&quot;]</code>ä¸Šçš„<code>.push()</code>æ–¹æ³•å·²ç»è¢«ä¿®æ”¹ä¸ºäº†<code>webpackJsonpCallback()</code>æ–¹æ³•ã€‚è¯¥æ–¹æ³•å¦‚ä¸‹ï¼š</p>

<pre><code class="language-javascript">// webpack runtime chunk
function webpackJsonpCallback(data) {
    var chunkIds = data[0];
    var moreModules = data[1];
    var executeModules = data[2];

    var moduleId, chunkId, i = 0, resolves = [];
    // webpackä¼šåœ¨installChunksä¸­å­˜å‚¨chunkçš„è½½å…¥çŠ¶æ€ï¼Œæ®æ­¤åˆ¤æ–­chunkæ˜¯å¦åŠ è½½å®Œæ¯•
    for(;i &lt; chunkIds.length; i++) {
        chunkId = chunkIds[i];
        if(installedChunks[chunkId]) {
            resolves.push(installedChunks[chunkId][0]);
        }
        installedChunks[chunkId] = 0;
    }
    
    // æ³¨æ„ï¼Œè¿™é‡Œä¼šè¿›è¡Œâ€œæ³¨å†Œâ€ï¼Œå°†æ¨¡å—æš‚å­˜å…¥å†…å­˜ä¸­
    // å°†module chunkä¸­ç¬¬äºŒä¸ªæ•°ç»„å…ƒç´ åŒ…å«çš„ module æ–¹æ³•æ³¨å†Œåˆ° modules å¯¹è±¡é‡Œ
    for(moduleId in moreModules) {
        if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
            modules[moduleId] = moreModules[moduleId];
        }
    }

    if(parentJsonpFunction) parentJsonpFunction(data);

    while(resolves.length) {
        resolves.shift()();
    }

    deferredModules.push.apply(deferredModules, executeModules || []);

    return checkDeferredModules();
};
</code></pre>

<p>æ³¨æ„ä»¥ä¸Šæ–¹æ³•çš„è¿™å‡ è¡Œï¼Œå°±æ˜¯æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„ã€Œå°†æ¨¡å—â€œæš‚å­˜â€åœ¨moduleså¯¹è±¡ä¸Šã€</p>

<pre><code class="language-JavaScript">// webpackJsonpCallback
for(moduleId in moreModules) {
    if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
    modules[moduleId] = moreModules[moduleId];
    }
}
</code></pre>

<p>é…åˆ<code>__webpack_require__()</code>ä¸­ä¸‹é¢è¿™ä¸€è¡Œä»£ç ï¼Œå°±å®ç°äº†åœ¨éœ€è¦å¼•å…¥æ¨¡å—æ—¶ï¼ŒåŒæ­¥åœ°å°†æ¨¡å—ä»æš‚å­˜åŒºå–å‡ºæ¥æ‰§è¡Œï¼Œé¿å…ä½¿ç”¨ç½‘ç»œè¯·æ±‚å¯¼è‡´è¿‡é•¿çš„åŒæ­¥ç­‰å¾…æ—¶é—´ã€‚</p>

<pre><code class="language-JavaScript">// __webpack_require__
modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
</code></pre>

<h3 id="toc_8">3.4. æ¨¡å—çš„è‡ªåŠ¨æ‰§è¡Œ</h3>

<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¯¹äºwebpackçš„åŒæ­¥ä¾èµ–å®ç°å·²ç»ä»‹ç»çš„å·®ä¸å¤šäº†ï¼Œä½†è¿˜é—ç•™ä¸€ä¸ªå°é—®é¢˜ï¼šwebpackä¸­çš„æ‰€æœ‰jsæºæ–‡ä»¶éƒ½æ˜¯æ¨¡å—ï¼Œä½†å¦‚æœéƒ½æ˜¯ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œçš„æ¨¡å—ï¼Œé‚£æˆ‘ä»¬åªæ˜¯åœ¨å‰ç«¯å¼•å…¥äº†ä¸€å †â€œæ­»â€ä»£ç ï¼Œæ€ä¹ˆè®©ä»£ç â€œæ´»â€èµ·æ¥å‘¢ï¼Ÿ</p>

<p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªscriptæ ‡ç­¾åŠ è½½è„šæœ¬æ–‡ä»¶ï¼Œè‡³å°‘å¸Œæœ›å…¶ä¸­ä¸€ä¸ªæ¨¡å—çš„ä»£ç ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œè€Œä¸ä»…ä»…æ˜¯æ³¨å†Œåœ¨<code>modules</code>å¯¹è±¡ä¸Šã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™å°±æ˜¯webpackä¸­æ‰€è°“çš„å…¥å£æ¨¡å—ã€‚</p>

<p>webpackæ˜¯å¦‚ä½•è®©è¿™äº›å…¥å£æ¨¡å—è‡ªåŠ¨æ‰§è¡Œçš„å‘¢ï¼Ÿä¸çŸ¥é“ä½ æ˜¯å¦è¿˜è®°å¾—module chunkä¸­é‚£ä¸ªæŒ‰ä¸‹ä¸è¡¨çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ•°ç»„é‡Œé¢æ¯ä¸ªå…ƒç´ åˆæ˜¯ä¸€ä¸ªæ•°ç»„</p>

<pre><code class="language-javascript">[[&quot;module-home-0&quot;,&quot;home-1&quot;], [&quot;module-home-2&quot;,&quot;home-3&quot;,&quot;home-5&quot;]]
</code></pre>

<p>å¯¹ç…§ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥å…·ä½“è§£é‡Šä¸‹å‚æ•°çš„å«ä¹‰ã€‚ç¬¬ä¸€ä¸ªå…ƒç´ <code>[&quot;module-home-0&quot;,&quot;home-1&quot;]</code>è¡¨ç¤ºï¼Œæˆ‘å¸Œæœ›è‡ªåŠ¨æ‰§è¡ŒmoduleIdä¸º<code>module-home-0</code>çš„è¿™ä¸ªæ¨¡å—ï¼Œä½†æ˜¯è¯¥æ¨¡å—éœ€è¦chunkIdä¸º<code>home-1</code>çš„chunkå·²ç»åŠ è½½åæ‰èƒ½æ‰§è¡Œï¼›åŒç†ï¼Œ<code>[&quot;module-home-2&quot;,&quot;home-3&quot;,&quot;home-5&quot;]</code>è¡¨ç¤ºè‡ªåŠ¨æ‰§è¡Œ<code>module-home-2</code>æ¨¡å—ï¼Œä½†æ˜¯éœ€è¦æ£€æŸ¥chunk<code>home-3</code>å’Œ<code>home-5</code>å·²ç»åŠ è½½ã€‚</p>

<p>æ‰§è¡ŒæŸäº›æ¨¡å—éœ€è¦ä¿è¯ä¸€äº›chunkå·²ç»åŠ è½½æ˜¯å› ä¸ºï¼Œè¯¥æ¨¡å—æ‰€ä¾èµ–çš„å…¶ä»–æ¨¡å—å¯èƒ½å¹¶ä¸åœ¨å½“å‰chunkä¸­ï¼Œè€Œwebpackåœ¨ç¼–è¯‘æœŸä¼šé€šè¿‡ä¾èµ–åˆ†æè‡ªåŠ¨å°†ä¾èµ–æ¨¡å—çš„æ‰€å±chunkIdæ³¨å…¥åˆ°æ­¤å¤„ã€‚</p>

<p>è¿™ä¸ªæ¨¡å—â€œè‡ªåŠ¨â€æ‰§è¡Œçš„åŠŸèƒ½åœ¨runtime chunkçš„ä»£ç ä¸­ä¸»è¦æ˜¯ç”±<code>checkDeferredModules()</code>æ–¹æ³•å®ç°ï¼š</p>

<pre><code class="language-JavaScript">function checkDeferredModules() {
    var result;
    for(var i = 0; i &lt; deferredModules.length; i++) {
        var deferredModule = deferredModules[i];
        var fulfilled = true;
        // ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ¨¡å—idï¼Œåé¢æ˜¯å…¶æ‰€éœ€çš„chunk
        for(var j = 1; j &lt; deferredModule.length; j++) {
            var depId = deferredModule[j];
            // è¿™é‡Œä¼šé¦–å…ˆåˆ¤æ–­æ¨¡å—æ‰€éœ€chunkæ˜¯å¦å·²ç»åŠ è½½å®Œæ¯•
            if(installedChunks[depId] !== 0) fulfilled = false;
        }
        // åªæœ‰æ¨¡å—æ‰€éœ€çš„chunkéƒ½åŠ è½½å®Œæ¯•ï¼Œè¯¥æ¨¡å—æ‰ä¼šè¢«æ‰§è¡Œï¼ˆ__webpack_require__ï¼‰
        if(fulfilled) {
            deferredModules.splice(i--, 1);
            result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
        }
    }
    return result;
}
</code></pre>

<h2 id="toc_9">4. å¼‚æ­¥ä¾èµ–</h2>

<p>å¦‚æœä½ åªæ˜¯æƒ³å­¦ä¹ webpackå‰ç«¯runtimeä¸­åŒæ­¥ä¾èµ–çš„è®¾è®¡ä¸å®ç°ï¼Œé‚£ä¹ˆåˆ°è¿™é‡Œä¸»è¦å†…å®¹åŸºæœ¬å·²ç»ç»“æŸäº†ã€‚ä¸è¿‡æˆ‘ä»¬çŸ¥é“ï¼Œwebpackæ”¯æŒä½¿ç”¨åŠ¨æ€æ¨¡å—å¼•å…¥çš„è¯­æ³•ï¼ˆä»£ç æ‹†åˆ†ï¼‰ï¼Œä¾‹å¦‚ï¼š<code>dynamic import</code>å’Œæ—©æœŸçš„<code>require.ensure</code>ï¼Œè¿™ç§æ–¹å¼ä¸ä½¿ç”¨CommonJSçš„<code>require</code>å’ŒESMçš„<code>import</code>æœ€é‡è¦çš„åŒºåˆ«åœ¨äºï¼Œè¯¥ç±»æ–¹æ³•ä¼šå¼‚æ­¥ï¼ˆæˆ–è€…è¯´æŒ‰éœ€ï¼‰åŠ è½½ä¾èµ–ã€‚</p>

<h3 id="toc_10">4.1. ä»£ç è½¬æ¢</h3>

<p>å°±åƒåœ¨æºç ä¸­ä½¿ç”¨<code>require</code>ä¼šåœ¨webpackæ‰“åŒ…æ—¶è¢«æ›¿æ¢ä¸º<code>__webpack_require__</code>ä¸€æ ·ï¼Œåœ¨æºç ä¸­ä½¿ç”¨çš„å¼‚æ­¥ä¾èµ–è¯­æ³•ä¹Ÿä¼šè¢«webpackä¿®æ”¹ã€‚ä»¥<code>dynamic import</code>ä¸ºä¾‹ï¼Œä¸‹é¢çš„ä»£ç </p>

<pre><code class="language-JavaScript">import(&#39;./test.js&#39;).then(mod =&gt; {
    console.log(mod);
});
</code></pre>

<p>åœ¨äº§å‡ºåä¼šè¢«è½¬æ¢ä¸º</p>

<pre><code class="language-JavaScript">__webpack_require__.e(/* import() */ &quot;home-1&quot;)
    .then(__webpack_require__.bind(null, &quot;module-home-3&quot;))
    .then(mod =&gt; {
        console.log(mod);
    });
</code></pre>

<p>ä¸Šé¢ä»£ç æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œwebpackæ‰“åŒ…åä¼šå°†ä¸€äº›moduleåˆå¹¶ä¸ºä¸€ä¸ªchunkï¼Œå› æ­¤ä¸Šé¢çš„<code>&quot;home-1&quot;</code>å°±è¡¨ç¤ºï¼šåŒ…å«<code>./test.js</code>æ¨¡å—çš„chunkçš„chunkIdä¸º<code>&quot;home-1&quot;</code>ã€‚</p>

<p>webpacké¦–å…ˆé€šè¿‡<code>__webpack_require__.e</code>åŠ è½½æŒ‡å®šchunkçš„scriptæ–‡ä»¶ï¼ˆmodule chunkï¼‰ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªpromiseï¼Œå½“scriptåŠ è½½å¹¶æ‰§è¡Œå®Œæˆåresolveè¯¥promiseã€‚webpackæ‰“åŒ…æ—¶ä¼šä¿è¯å¼‚æ­¥ä¾èµ–çš„æ‰€æœ‰æ¨¡å—éƒ½å·²åŒ…å«åœ¨è¯¥module chunkæˆ–å½“å‰ä¸Šä¸‹æ–‡ä¸­ã€‚</p>

<p>æ—¢ç„¶module chunkå·²ç»æ‰§è¡Œï¼Œé‚£ä¹ˆè¡¨æ˜å¼‚æ­¥ä¾èµ–å·²ç»å°±ç»ªï¼Œäºæ˜¯åœ¨thenæ–¹æ³•ä¸­æ‰§è¡Œ<code>__webpack_require__</code>å¼•ç”¨<code>test.js</code>æ¨¡å—ï¼ˆwebpackç¼–è¯‘åmoduleIdä¸ºmodule-home-3ï¼‰å¹¶è¿”å›ã€‚è¿™æ ·åœ¨ç¬¬äºŒä¸ªthenæ–¹æ³•ä¸­å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨è¯¥æ¨¡å—äº†ã€‚</p>

<h3 id="toc_11">4.2. <code>__webpack_require__.e</code></h3>

<p>å¼‚æ­¥ä¾èµ–çš„æ ¸å¿ƒæ–¹æ³•å°±æ˜¯<code>__webpack_require__.e</code>ã€‚ä¸‹é¢æ¥åˆ†æä¸€ä¸‹è¯¥æ–¹æ³•ï¼š</p>

<pre><code class="language-JavaScript">__webpack_require__.e = function requireEnsure(chunkId) {
    var promises = [];
    var installedChunkData = installedChunks[chunkId];
    
    // åˆ¤æ–­è¯¥chunkæ˜¯å¦å·²ç»è¢«åŠ è½½ï¼Œ0è¡¨ç¤ºå·²åŠ è½½ã€‚installChunkä¸­çš„çŠ¶æ€ï¼š
    // undefinedï¼šchunkæœªè¿›è¡ŒåŠ è½½,
    // nullï¼šchunk preloaded/prefetched
    // Promiseï¼šchunkæ­£åœ¨åŠ è½½ä¸­
    // 0ï¼šchunkåŠ è½½å®Œæ¯•
    if(installedChunkData !== 0) {
        // chunkä¸ä¸ºnullå’Œundefinedï¼Œåˆ™ä¸ºPromiseï¼Œè¡¨ç¤ºåŠ è½½ä¸­ï¼Œç»§ç»­ç­‰å¾…
        if(installedChunkData) {
            promises.push(installedChunkData[2]);
        } else {
            // æ³¨æ„è¿™é‡ŒinstallChunkçš„æ•°æ®æ ¼å¼
            // ä»å·¦åˆ°å³ä¸‰ä¸ªå…ƒç´ åˆ†åˆ«ä¸ºresolveã€rejectã€promise
            var promise = new Promise(function(resolve, reject) {
                installedChunkData = installedChunks[chunkId] = [resolve, reject];
            });
            promises.push(installedChunkData[2] = promise);

            // ä¸‹é¢ä»£ç ä¸»è¦æ˜¯æ ¹æ®chunkIdåŠ è½½å¯¹åº”çš„scriptè„šæœ¬
            var head = document.getElementsByTagName(&#39;head&#39;)[0];
            var script = document.createElement(&#39;script&#39;);
            var onScriptComplete;

            script.charset = &#39;utf-8&#39;;
            script.timeout = 120;
            if (__webpack_require__.nc) {
                script.setAttribute(&quot;nonce&quot;, __webpack_require__.nc);
            }
            
            // jsonpScriptSrcæ–¹æ³•ä¼šæ ¹æ®ä¼ å…¥çš„chunkIdè¿”å›å¯¹åº”çš„æ–‡ä»¶è·¯å¾„
            script.src = jsonpScriptSrc(chunkId);

            onScriptComplete = function (event) {
                script.onerror = script.onload = null;
                clearTimeout(timeout);
                var chunk = installedChunks[chunkId];
                if(chunk !== 0) {
                    if(chunk) {
                        var errorType = event &amp;&amp; (event.type === &#39;load&#39; ? &#39;missing&#39; : event.type);
                        var realSrc = event &amp;&amp; event.target &amp;&amp; event.target.src;
                        var error = new Error(&#39;Loading chunk &#39; + chunkId + &#39; failed.\n(&#39; + errorType + &#39;: &#39; + realSrc + &#39;)&#39;);
                        error.type = errorType;
                        error.request = realSrc;
                        chunk[1](error);
                    }
                    installedChunks[chunkId] = undefined;
                }
            };
            var timeout = setTimeout(function(){
                onScriptComplete({ type: &#39;timeout&#39;, target: script });
            }, 120000);
            script.onerror = script.onload = onScriptComplete;
            head.appendChild(script);
        }
    }
    return Promise.all(promises);
};
</code></pre>

<p>è¯¥æ–¹æ³•é¦–å…ˆä¼šæ ¹æ®chunkIdåœ¨installChunksä¸­åˆ¤æ–­è¯¥chunkæ˜¯å¦æ­£åœ¨åŠ è½½æˆ–å·²ç»è¢«åŠ è½½ï¼›å¦‚æœæ²¡æœ‰åˆ™ä¼šåˆ›å»ºä¸€ä¸ªpromiseï¼Œå°†å…¶ä¿å­˜åœ¨installChunksä¸­ï¼Œå¹¶é€šè¿‡<code>jsonpScriptSrc()</code>æ–¹æ³•è·å–æ–‡ä»¶è·¯å¾„ï¼Œé€šè¿‡sciriptæ ‡ç­¾åŠ è½½ï¼Œæœ€åè¿”å›è¯¥promiseã€‚</p>

<p><code>jsonpScriptSrc()</code>åˆ™å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªåŒ…å«chunk mapçš„æ–¹æ³•ï¼Œä¾‹å¦‚è¿™ä¸ªä¾‹å­ä¸­ï¼š</p>

<pre><code class="language-JavaScript">function jsonpScriptSrc(chunkId) {
    return __webpack_require__.p + &quot;&quot; + ({}[chunkId]||chunkId) + &quot;.&quot; + {&quot;home-1&quot;:&quot;0b49ae3b&quot;}[chunkId] + &quot;.js&quot;
}
</code></pre>

<p>å…¶ä¸­åŒ…å«ä¸€ä¸ªmap â€”â€” <code>{&quot;home-1&quot;:&quot;0b49ae3b&quot;}</code>ï¼Œä¼šæ ¹æ®home-1è¿™ä¸ªchunkIdè¿”å›home-1.0b49ae3b.jsè¿™ä¸ªæ–‡ä»¶åã€‚</p>

<h3 id="toc_12">4.3. æ›´æ–°chunkåŠ è½½çŠ¶æ€</h3>

<p>æœ€åï¼Œä½ ä¼šå‘ç°ï¼Œåœ¨onloadä¸­ï¼Œå¹¶æ²¡æœ‰è°ƒç”¨promiseçš„resolveæ–¹æ³•ã€‚é‚£ä¹ˆæ˜¯ä½•æ—¶resolveçš„å‘¢ï¼Ÿ</p>

<p>ä½ è¿˜è®°å¾—åœ¨ä»‹ç»åŒæ­¥requireæ—¶ç”¨äºæ³¨å†Œmoduleçš„<code>webpackJsonpCallback()</code>æ–¹æ³•ä¹ˆï¼Ÿæˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œè¯¥æ–¹æ³•å‚æ•°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªchunkIdçš„æ•°ç»„ï¼Œä»£è¡¨äº†è¯¥è„šæœ¬æ‰€åŒ…å«çš„chunkã€‚</p>

<blockquote>
<p>p.s. å½“ä¸€ä¸ªæ™®é€šçš„è„šæœ¬è¢«æµè§ˆå™¨ä¸‹è½½å®Œæ¯•åï¼Œä¼šå…ˆæ‰§è¡Œè¯¥è„šæœ¬ï¼Œç„¶åè§¦å‘onloadäº‹ä»¶ã€‚</p>
</blockquote>

<p>å› æ­¤ï¼Œåœ¨<code>webpackJsonpCallback()</code>æ–¹æ³•ä¸­ï¼Œæœ‰ä¸€æ®µä»£ç å°±æ˜¯æ ¹æ®chunkIdsçš„æ•°ç»„ï¼Œæ£€æŸ¥å¹¶æ›´æ–°chunkçš„åŠ è½½çŠ¶æ€ï¼š</p>

<pre><code class="language-JavaScript">// webpackJsonpCallback()
var moduleId, chunkId, i = 0, resolves = [];
for(;i &lt; chunkIds.length; i++) {
    chunkId = chunkIds[i];
    if(installedChunks[chunkId]) {
        resolves.push(installedChunks[chunkId][0]);
    }
    installedChunks[chunkId] = 0;
}

// â€¦â€¦

while(resolves.length) {
    resolves.shift()();
}
</code></pre>

<p>ä¸Šé¢çš„ä»£ç å…ˆæ ¹æ®æ¨¡å—æ³¨å†Œæ—¶çš„chunkIdï¼Œå–å‡ºinstalledChunkså¯¹åº”çš„æ‰€æœ‰loadingä¸­çš„chunkï¼Œæœ€åå°†è¿™äº›chunkçš„promiseè¿›è¡Œresolveæ“ä½œã€‚</p>

<h2 id="toc_13">5. å†™åœ¨æœ€å</h2>

<p>è‡³æ­¤ï¼Œå¯¹äºã€Œwebpackæ‰“åŒ…åæ˜¯å¦‚ä½•å®ç°å‰ç«¯æ¨¡å—åŒ–ã€è¿™ä¸ªé—®é¢˜å°±å·®ä¸å¤šç»“æŸäº†ã€‚æœ¬æ–‡é€šè¿‡Nodeä¸­çš„æ¨¡å—åŒ–ä¸ºå¼•å­ï¼Œä»‹ç»äº†webpackä¸­çš„åŒæ­¥ä¸å¼‚æ­¥æ¨¡å—åŠ è½½çš„è®¾è®¡ä¸å®ç°ã€‚</p>

<p>ä¸ºäº†æ–¹ä¾¿å¤§å®¶å¯¹ç…§æ–‡ä¸­å†…å®¹æŸ¥çœ‹webpackè¿è¡Œæ—¶æºç ï¼Œæˆ‘æŠŠåŸºç¡€çš„webpack runtime chunkå’Œmodule chunkæ”¾åœ¨äº†<a href="https://gitee.com/alienzhou/codes/o431yhewq8kimbtdnjpcl12">è¿™é‡Œ</a>ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥å¯¹ç…§ç€çœ‹ã€‚</p>

<p>æœ€åè¿˜æ˜¯æ¬¢è¿å¯¹webpackæ„Ÿå…´è¶£çš„æœ‹å‹èƒ½å¤Ÿç›¸äº’äº¤æµï¼Œå…³æ³¨æˆ‘çš„ç³»åˆ—æ–‡ç« ã€‚</p>

<h2 id="toc_14">å‚è€ƒèµ„æ–™</h2>

<ul>
<li><a href="https://github.com/nodejs/node/blob/master/lib/internal/modules/cjs/loader.js">NodeJS internal - cjs module loader</a></li>
<li><a href="https://github.com/webpack/webpack/blob/master/lib/MainTemplate.js">webpack MainTemplate</a></li>
<li><a href="https://github.com/webpack/webpack/blob/master/lib/FunctionModuleTemplatePlugin.js">webpack FunctionModuleTemplatePlugin</a></li>
<li><a href="https://github.com/webpack/webpack/blob/master/lib/RuntimeTemplate.js">webpack RuntimeTemplate</a></li>
<li><a href="https://gitee.com/alienzhou/codes/o431yhewq8kimbtdnjpcl12">webpack runtime chunkç¤ºä¾‹</a></li>
</ul>


</div>

<br /><br />
<hr />

<div class="row clearfix">
  <div class="large-6 columns">
	<div class="text-left" style="padding:15px 0px;">
		
	        <a href="15354508213008.html"  title="Previous Post: ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ">&laquo; ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ</a>
	    
	</div>
  </div>
  <div class="large-6 columns">
	<div class="text-right" style="padding:15px 0px;">
		
	        <a href="15333560595579.html" 
	        title="Next Post: æ¨èé˜…è¯» 2018.08">æ¨èé˜…è¯» 2018.08 &raquo;</a>
	    
	</div>
  </div>
</div>

<div class="row">
<div style="padding:0px 0.93em;" class="share-comments">

</div>
</div>
<script type="text/javascript">
	$(function(){
		var currentURL = '15353386669734.html';
		$('#side-nav a').each(function(){
			if($(this).attr('href') == currentURL){
				$(this).parent().addClass('active');
			}
		});
	});
</script>  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    


  </body>
</html>
