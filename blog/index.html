<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  AlienZHOU's blog
  
  </title>
 <meta name="description" content="">
 <link href="atom.xml" rel="alternate" title="AlienZHOU's blog" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">AlienZHOU's blog</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; AlienZHOU's blog</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>PWA</label></li>

          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ" href="15354508213008.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(9)ç”Ÿäº§ç¯å¢ƒä¸­PWAå®è·µçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" href="15288038664515.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(9)ç”Ÿäº§ç¯å¢ƒä¸­PWAå®è·µçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(8)ä½¿ç”¨Service Workerè¿›è¡Œåå°åŒæ­¥ - Background Sync" href="15288038009038.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(8)ä½¿ç”¨Service Workerè¿›è¡Œåå°åŒæ­¥ - Background Sync</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(7)ä½¿ç”¨Notification APIæ¥è¿›è¡Œæ¶ˆæ¯æé†’" href="15288036503920.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(7)ä½¿ç”¨Notification APIæ¥è¿›è¡Œæ¶ˆæ¯æé†’</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(6) åœ¨Chromeä¸­è°ƒè¯•ä½ çš„PWA" href="15288035758780.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(6) åœ¨Chromeä¸­è°ƒè¯•ä½ çš„PWA</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(5)åœ¨Webä¸­è¿›è¡ŒæœåŠ¡ç«¯æ¶ˆæ¯æ¨é€" href="15288030176091.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(5)åœ¨Webä¸­è¿›è¡ŒæœåŠ¡ç«¯æ¶ˆæ¯æ¨é€</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(4) è§£å†³FireBase loginéªŒè¯å¤±è´¥é—®é¢˜" href="15235166926023.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(4) è§£å†³FireBase loginéªŒè¯å¤±è´¥é—®é¢˜</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(3) è®©ä½ çš„WebAppç¦»çº¿å¯ç”¨" href="15235151669706.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(3) è®©ä½ çš„WebAppç¦»çº¿å¯ç”¨</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(2) ä½¿ç”¨Manifestï¼Œè®©ä½ çš„WebAppæ›´â€œNativeâ€" href="15235140795593.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(2) ä½¿ç”¨Manifestï¼Œè®©ä½ çš„WebAppæ›´â€œNativeâ€</a></li>
          
            <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(1) 2018ï¼Œå¼€å§‹ä½ çš„PWAå­¦ä¹ ä¹‹æ—…" href="15235138633619.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(1) 2018ï¼Œå¼€å§‹ä½ çš„PWAå­¦ä¹ ä¹‹æ—…</a></li>
          

      
        <li class="divider"></li>
        <li><label>React</label></li>

          
            <li><a title="åŸºäºreactæŠ€æœ¯æ ˆçš„å•é¡µåº”ç”¨(SPA)æ­å»º_å¿«é€Ÿå…¥é—¨å®è·µ" href="15236392559880.html">åŸºäºreactæŠ€æœ¯æ ˆçš„å•é¡µåº”ç”¨(SPA)æ­å»º_å¿«é€Ÿå…¥é—¨å®è·µ</a></li>
          
            <li><a title="åœ¨react-router4ä¸­è¿›è¡Œä»£ç æ‹†åˆ†ï¼ˆåŸºäºwebpackï¼‰" href="15235187668595.html">åœ¨react-router4ä¸­è¿›è¡Œä»£ç æ‹†åˆ†ï¼ˆåŸºäºwebpackï¼‰</a></li>
          

      
        <li class="divider"></li>
        <li><label>CSS</label></li>

          
            <li><a title="CSSå¸ƒå±€å­¦ä¹ æŒ‡å—[è¯‘]" href="15301745888974.html">CSSå¸ƒå±€å­¦ä¹ æŒ‡å—[è¯‘]</a></li>
          
            <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(3) ä½¿ç”¨ğŸ’…styled-componentsæ¥ä¼˜åŒ–reactç»„ä»¶å¼€å‘" href="15236398426783.html">ã€CSSæ¨¡å—åŒ–ã€‘(3) ä½¿ç”¨ğŸ’…styled-componentsæ¥ä¼˜åŒ–reactç»„ä»¶å¼€å‘</a></li>
          
            <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(2) BEMå‘½åæ–¹æ³•è®ºâ€”â€”ä½¿ç”¨BEM-constructoræ„å»ºCSS" href="15236396803035.html">ã€CSSæ¨¡å—åŒ–ã€‘(2) BEMå‘½åæ–¹æ³•è®ºâ€”â€”ä½¿ç”¨BEM-constructoræ„å»ºCSS</a></li>
          
            <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(1) webpackä¹‹Local Scope" href="15236395841604.html">ã€CSSæ¨¡å—åŒ–ã€‘(1) webpackä¹‹Local Scope</a></li>
          

      
        <li class="divider"></li>
        <li><label>Server</label></li>

          
            <li><a title="ã€MongoDBé«˜å¯ç”¨ã€‘å¤åˆ¶é›†Replica Setä½¿ç”¨ç®€ä»‹" href="15236400113573.html">ã€MongoDBé«˜å¯ç”¨ã€‘å¤åˆ¶é›†Replica Setä½¿ç”¨ç®€ä»‹</a></li>
          

      
        <li class="divider"></li>
        <li><label>Automation</label></li>

          
            <li><a title="Gulp.jså®è·µè¯¦è§£__åŸºäºGulpçš„å¤šé¡µé¢åº”ç”¨å®è·µæŒ‡å—" href="15236401468681.html">Gulp.jså®è·µè¯¦è§£__åŸºäºGulpçš„å¤šé¡µé¢åº”ç”¨å®è·µæŒ‡å—</a></li>
          

      
        <li class="divider"></li>
        <li><label>FE else</label></li>

          
            <li><a title="å„ç±»â€œæœåŠ¡å™¨æ¨â€æŠ€æœ¯åŸç†ä¸å®ä¾‹ï¼ˆPolling/COMET/SSE/WebSocketï¼‰" href="15288039493853.html">å„ç±»â€œæœåŠ¡å™¨æ¨â€æŠ€æœ¯åŸç†ä¸å®ä¾‹ï¼ˆPolling/COMET/SSE/WebSocketï¼‰</a></li>
          
            <li><a title="æµè§ˆå™¨åŒæºç­–ç•¥ä¸ajaxè·¨åŸŸæ–¹æ³•æ±‡æ€»" href="15236404711802.html">æµè§ˆå™¨åŒæºç­–ç•¥ä¸ajaxè·¨åŸŸæ–¹æ³•æ±‡æ€»</a></li>
          
            <li><a title="JavaScriptå¼‚æ­¥ç¼–ç¨‹__â€œå›è°ƒåœ°ç‹±â€çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ" href="15236403350295.html">JavaScriptå¼‚æ­¥ç¼–ç¨‹__â€œå›è°ƒåœ°ç‹±â€çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ</a></li>
          
            <li><a title="jsæ§åˆ¶inputæ¡†å†…å…‰æ ‡ä½ç½®ï¼ˆsetSelectionRangeè¯¦è§£ï¼‰" href="15236405992551.html">jsæ§åˆ¶inputæ¡†å†…å…‰æ ‡ä½ç½®ï¼ˆsetSelectionRangeè¯¦è§£ï¼‰</a></li>
          

      
        <li class="divider"></li>
        <li><label>Reading</label></li>

          
            <li><a title="æ¨èé˜…è¯» 2018.08" href="15333560595579.html">æ¨èé˜…è¯» 2018.08</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.07" href="15307688152882.html">æ¨èé˜…è¯» 2018.07</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.06" href="15288017709756.html">æ¨èé˜…è¯» 2018.06</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.05" href="15287963471356.html">æ¨èé˜…è¯» 2018.05</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.04" href="15283399559020.html">æ¨èé˜…è¯» 2018.04</a></li>
          
            <li><a title="æ¨èé˜…è¯» 2018.03" href="15282529256902.html">æ¨èé˜…è¯» 2018.03</a></li>
          

      
        <li class="divider"></li>
        <li><label>Performace</label></li>

          
            <li><a title="ã€æ€§èƒ½ä¼˜åŒ–å®è·µã€‘ä¼˜åŒ–æ‰“åŒ…ç­–ç•¥æå‡é¡µé¢åŠ è½½é€Ÿåº¦" href="15288037747207.html">ã€æ€§èƒ½ä¼˜åŒ–å®è·µã€‘ä¼˜åŒ–æ‰“åŒ…ç­–ç•¥æå‡é¡µé¢åŠ è½½é€Ÿåº¦</a></li>
          

      
        <li class="divider"></li>
        <li><label>webpack</label></li>

          
            <li><a title="ã€webpackè¿›é˜¶ã€‘ä½¿ç”¨babelé¿å…webpackç¼–è¯‘è¿è¡Œæ—¶æ¨¡å—ä¾èµ–" href="15354509456422.html">ã€webpackè¿›é˜¶ã€‘ä½¿ç”¨babelé¿å…webpackç¼–è¯‘è¿è¡Œæ—¶æ¨¡å—ä¾èµ–</a></li>
          
            <li><a title="ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç°" href="15353386669734.html">ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç°</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>PWA</span></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ" href="15354508213008.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(10)ä½¿ç”¨Resource Hintæå‡é¡µé¢åŠ è½½æ€§èƒ½ä¸ä½“éªŒ</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(9)ç”Ÿäº§ç¯å¢ƒä¸­PWAå®è·µçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" href="15288038664515.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(9)ç”Ÿäº§ç¯å¢ƒä¸­PWAå®è·µçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(8)ä½¿ç”¨Service Workerè¿›è¡Œåå°åŒæ­¥ - Background Sync" href="15288038009038.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(8)ä½¿ç”¨Service Workerè¿›è¡Œåå°åŒæ­¥ - Background Sync</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(7)ä½¿ç”¨Notification APIæ¥è¿›è¡Œæ¶ˆæ¯æé†’" href="15288036503920.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(7)ä½¿ç”¨Notification APIæ¥è¿›è¡Œæ¶ˆæ¯æé†’</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(6) åœ¨Chromeä¸­è°ƒè¯•ä½ çš„PWA" href="15288035758780.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(6) åœ¨Chromeä¸­è°ƒè¯•ä½ çš„PWA</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(5)åœ¨Webä¸­è¿›è¡ŒæœåŠ¡ç«¯æ¶ˆæ¯æ¨é€" href="15288030176091.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(5)åœ¨Webä¸­è¿›è¡ŒæœåŠ¡ç«¯æ¶ˆæ¯æ¨é€</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(4) è§£å†³FireBase loginéªŒè¯å¤±è´¥é—®é¢˜" href="15235166926023.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(4) è§£å†³FireBase loginéªŒè¯å¤±è´¥é—®é¢˜</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(3) è®©ä½ çš„WebAppç¦»çº¿å¯ç”¨" href="15235151669706.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(3) è®©ä½ çš„WebAppç¦»çº¿å¯ç”¨</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(2) ä½¿ç”¨Manifestï¼Œè®©ä½ çš„WebAppæ›´â€œNativeâ€" href="15235140795593.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(2) ä½¿ç”¨Manifestï¼Œè®©ä½ çš„WebAppæ›´â€œNativeâ€</a></li>
                        
                          <li><a title="ã€PWAå­¦ä¹ ä¸å®è·µã€‘(1) 2018ï¼Œå¼€å§‹ä½ çš„PWAå­¦ä¹ ä¹‹æ—…" href="15235138633619.html">ã€PWAå­¦ä¹ ä¸å®è·µã€‘(1) 2018ï¼Œå¼€å§‹ä½ çš„PWAå­¦ä¹ ä¹‹æ—…</a></li>
                        

                    
                      <li class="side-title"><span>React</span></li>
                        
                          <li><a title="åŸºäºreactæŠ€æœ¯æ ˆçš„å•é¡µåº”ç”¨(SPA)æ­å»º_å¿«é€Ÿå…¥é—¨å®è·µ" href="15236392559880.html">åŸºäºreactæŠ€æœ¯æ ˆçš„å•é¡µåº”ç”¨(SPA)æ­å»º_å¿«é€Ÿå…¥é—¨å®è·µ</a></li>
                        
                          <li><a title="åœ¨react-router4ä¸­è¿›è¡Œä»£ç æ‹†åˆ†ï¼ˆåŸºäºwebpackï¼‰" href="15235187668595.html">åœ¨react-router4ä¸­è¿›è¡Œä»£ç æ‹†åˆ†ï¼ˆåŸºäºwebpackï¼‰</a></li>
                        

                    
                      <li class="side-title"><span>CSS</span></li>
                        
                          <li><a title="CSSå¸ƒå±€å­¦ä¹ æŒ‡å—[è¯‘]" href="15301745888974.html">CSSå¸ƒå±€å­¦ä¹ æŒ‡å—[è¯‘]</a></li>
                        
                          <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(3) ä½¿ç”¨ğŸ’…styled-componentsæ¥ä¼˜åŒ–reactç»„ä»¶å¼€å‘" href="15236398426783.html">ã€CSSæ¨¡å—åŒ–ã€‘(3) ä½¿ç”¨ğŸ’…styled-componentsæ¥ä¼˜åŒ–reactç»„ä»¶å¼€å‘</a></li>
                        
                          <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(2) BEMå‘½åæ–¹æ³•è®ºâ€”â€”ä½¿ç”¨BEM-constructoræ„å»ºCSS" href="15236396803035.html">ã€CSSæ¨¡å—åŒ–ã€‘(2) BEMå‘½åæ–¹æ³•è®ºâ€”â€”ä½¿ç”¨BEM-constructoræ„å»ºCSS</a></li>
                        
                          <li><a title="ã€CSSæ¨¡å—åŒ–ã€‘(1) webpackä¹‹Local Scope" href="15236395841604.html">ã€CSSæ¨¡å—åŒ–ã€‘(1) webpackä¹‹Local Scope</a></li>
                        

                    
                      <li class="side-title"><span>Server</span></li>
                        
                          <li><a title="ã€MongoDBé«˜å¯ç”¨ã€‘å¤åˆ¶é›†Replica Setä½¿ç”¨ç®€ä»‹" href="15236400113573.html">ã€MongoDBé«˜å¯ç”¨ã€‘å¤åˆ¶é›†Replica Setä½¿ç”¨ç®€ä»‹</a></li>
                        

                    
                      <li class="side-title"><span>Automation</span></li>
                        
                          <li><a title="Gulp.jså®è·µè¯¦è§£__åŸºäºGulpçš„å¤šé¡µé¢åº”ç”¨å®è·µæŒ‡å—" href="15236401468681.html">Gulp.jså®è·µè¯¦è§£__åŸºäºGulpçš„å¤šé¡µé¢åº”ç”¨å®è·µæŒ‡å—</a></li>
                        

                    
                      <li class="side-title"><span>FE else</span></li>
                        
                          <li><a title="å„ç±»â€œæœåŠ¡å™¨æ¨â€æŠ€æœ¯åŸç†ä¸å®ä¾‹ï¼ˆPolling/COMET/SSE/WebSocketï¼‰" href="15288039493853.html">å„ç±»â€œæœåŠ¡å™¨æ¨â€æŠ€æœ¯åŸç†ä¸å®ä¾‹ï¼ˆPolling/COMET/SSE/WebSocketï¼‰</a></li>
                        
                          <li><a title="æµè§ˆå™¨åŒæºç­–ç•¥ä¸ajaxè·¨åŸŸæ–¹æ³•æ±‡æ€»" href="15236404711802.html">æµè§ˆå™¨åŒæºç­–ç•¥ä¸ajaxè·¨åŸŸæ–¹æ³•æ±‡æ€»</a></li>
                        
                          <li><a title="JavaScriptå¼‚æ­¥ç¼–ç¨‹__â€œå›è°ƒåœ°ç‹±â€çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ" href="15236403350295.html">JavaScriptå¼‚æ­¥ç¼–ç¨‹__â€œå›è°ƒåœ°ç‹±â€çš„ä¸€äº›è§£å†³æ–¹æ¡ˆ</a></li>
                        
                          <li><a title="jsæ§åˆ¶inputæ¡†å†…å…‰æ ‡ä½ç½®ï¼ˆsetSelectionRangeè¯¦è§£ï¼‰" href="15236405992551.html">jsæ§åˆ¶inputæ¡†å†…å…‰æ ‡ä½ç½®ï¼ˆsetSelectionRangeè¯¦è§£ï¼‰</a></li>
                        

                    
                      <li class="side-title"><span>Reading</span></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.08" href="15333560595579.html">æ¨èé˜…è¯» 2018.08</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.07" href="15307688152882.html">æ¨èé˜…è¯» 2018.07</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.06" href="15288017709756.html">æ¨èé˜…è¯» 2018.06</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.05" href="15287963471356.html">æ¨èé˜…è¯» 2018.05</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.04" href="15283399559020.html">æ¨èé˜…è¯» 2018.04</a></li>
                        
                          <li><a title="æ¨èé˜…è¯» 2018.03" href="15282529256902.html">æ¨èé˜…è¯» 2018.03</a></li>
                        

                    
                      <li class="side-title"><span>Performace</span></li>
                        
                          <li><a title="ã€æ€§èƒ½ä¼˜åŒ–å®è·µã€‘ä¼˜åŒ–æ‰“åŒ…ç­–ç•¥æå‡é¡µé¢åŠ è½½é€Ÿåº¦" href="15288037747207.html">ã€æ€§èƒ½ä¼˜åŒ–å®è·µã€‘ä¼˜åŒ–æ‰“åŒ…ç­–ç•¥æå‡é¡µé¢åŠ è½½é€Ÿåº¦</a></li>
                        

                    
                      <li class="side-title"><span>webpack</span></li>
                        
                          <li><a title="ã€webpackè¿›é˜¶ã€‘ä½¿ç”¨babelé¿å…webpackç¼–è¯‘è¿è¡Œæ—¶æ¨¡å—ä¾èµ–" href="15354509456422.html">ã€webpackè¿›é˜¶ã€‘ä½¿ç”¨babelé¿å…webpackç¼–è¯‘è¿è¡Œæ—¶æ¨¡å—ä¾èµ–</a></li>
                        
                          <li><a title="ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç°" href="15353386669734.html">ã€webpackè¿›é˜¶ã€‘å‰ç«¯è¿è¡Œæ—¶çš„æ¨¡å—åŒ–è®¾è®¡ä¸å®ç°</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 


	
		<div class="markdown-body">
		<h1>ã€webpackè¿›é˜¶ã€‘ä½¿ç”¨babelé¿å…webpackç¼–è¯‘è¿è¡Œæ—¶æ¨¡å—ä¾èµ–</h1>

		<h2 id="toc_0">å¼•è¨€</h2>

<p>babelæ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œä½œç”¨è¿œä¸æ­¢æˆ‘ä»¬å¹³æ—¶çš„ES6 -&gt; ES5è¯­æ³•è½¬æ¢è¿™ä¹ˆå•ä¸€ã€‚åœ¨å‰ç«¯è¿›é˜¶çš„é“è·¯ä¸Šï¼Œäº†è§£ä¸å­¦ä¹ babelåŠå…¶çµæ´»çš„æ’ä»¶æ¨¡å¼å°†ä¼šä¸ºå‰ç«¯èµ‹äºˆæ›´å¤šçš„å¯èƒ½æ€§ã€‚</p>

<p>æœ¬æ–‡å°±æ˜¯è¿ç”¨babelï¼Œé€šè¿‡ç¼–å†™babelæ’ä»¶è§£å†³äº†ä¸€ä¸ªå®é™…é¡¹ç›®ä¸­çš„é—®é¢˜ã€‚</p>

<blockquote>
<p>æœ¬æ–‡ç›¸å…³ä»£ç å·²æ‰˜ç®¡è‡³github: <a href="https://github.com/alienzhou/babel-plugin-import-customized-require">babel-plugin-import-customized-require</a></p>
</blockquote>

<h2 id="toc_1">1. é‡åˆ°çš„é—®é¢˜</h2>

<p>æœ€è¿‘åœ¨é¡¹ç›®ä¸­é‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬çŸ¥é“ï¼Œä½¿ç”¨webpackä½œä¸ºæ„å»ºå·¥å…·æ˜¯ä¼šé»˜è®¤è‡ªåŠ¨å¸®æˆ‘ä»¬è¿›è¡Œä¾èµ–æ„å»ºï¼›ä½†æ˜¯åœ¨é¡¹ç›®ä»£ç ä¸­ï¼Œæœ‰ä¸€éƒ¨åˆ†çš„ä¾èµ–æ˜¯è¿è¡Œæ—¶ä¾èµ–/éç¼–è¯‘æœŸä¾èµ–ï¼ˆå¯ä»¥ç†è§£ä¸ºåƒrequirejsã€seajsé‚£æ ·çš„çº¯å‰ç«¯æ¨¡å—åŒ–ï¼‰ï¼Œå¯¹äºè¿™ç§ä¾èµ–ä¸åšå¤„ç†ä¼šå¯¼è‡´webpackç¼–è¯‘å‡ºé”™ã€‚</p>

<p>ä¸ºä»€ä¹ˆéœ€è¦éç¼–è¯‘æœŸä¾èµ–å‘¢ï¼Ÿä¾‹å¦‚ï¼Œåœ¨å½“å‰çš„ä¸šåŠ¡æ¨¡å—ï¼ˆä¸€ä¸ªç‹¬ç«‹çš„webpackä»£ç ä»“åº“ï¼‰é‡Œï¼Œæˆ‘ä¾èµ–äº†ä¸€ä¸ªå…¬å…±ä¸šåŠ¡æ¨¡å—çš„æ‰“ç‚¹ä»£ç </p>

<pre><code class="language-javascript">// è¿™æ˜¯homeä¸šåŠ¡æ¨¡å—ä»£ç 
// ä¾èµ–äº†commonä¸šåŠ¡æ¨¡å—çš„ä»£ç 
import log from &#39;common:util/log.js&#39;

log(&#39;act-1&#39;);
</code></pre>

<p>ç„¶è€Œï¼Œå¯èƒ½æ˜¯ç”±äºæŠ€æœ¯æ ˆä¸ç»Ÿä¸€ï¼Œæˆ–æ˜¯å› ä¸ºcommonä¸šåŠ¡ä»£ç é—ç•™é—®é¢˜æ— æ³•é‡æ„ï¼Œæˆ–è€…ä»…ä»…æ˜¯ä¸ºäº†ä¸šåŠ¡æ¨¡å—çš„åˆ†æ²»â€¦â€¦æ€»ä¹‹ï¼Œæ— æ³•åœ¨webpackç¼–è¯‘æœŸè§£å†³è¿™éƒ¨åˆ†æ¨¡å—ä¾èµ–ï¼Œè€Œæ˜¯éœ€è¦æ”¾åœ¨å‰ç«¯è¿è¡Œæ—¶æ¡†æ¶è§£å†³ã€‚</p>

<p>ä¸ºäº†è§£å†³webpackç¼–è¯‘æœŸæ— æ³•è§£æè¿™ç§æ¨¡å—ä¾èµ–çš„é—®é¢˜ï¼Œå¯ä»¥ç»™è¿™ç§éç¼–è¯‘æœŸä¾èµ–å¼•å…¥æ–°çš„è¯­æ³•ï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ ·ï¼š</p>

<pre><code class="language-javascript">// __my_require__æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„å‰ç«¯requireæ–¹æ³•
var log = __my_require__(&#39;common:util/log.js&#39;)

log(&#39;act-1&#39;);
</code></pre>

<p>ä½†è¿™æ ·å°±å¯¼è‡´äº†æˆ‘ä»¬ä»£ç å½¢å¼çš„åˆ†è£‚ï¼Œæ‹¥æŠ±è§„èŒƒè®©æˆ‘ä»¬å¸Œæœ›è¿˜æ˜¯èƒ½å¤Ÿç”¨ESMçš„æ ‡å‡†è¯­æ³•æ¥ä¸€è§†åŒä»ã€‚</p>

<p>æˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›èƒ½åƒä¸‹é¢è¿™æ ·å†™ä»£ç ï¼š</p>

<pre><code class="language-javascript">// æ ‡å‡†çš„ESMè¯­æ³•
import * as log from &#39;common:util/log.js&#39;;

log(&#39;act-1&#39;);
</code></pre>

<p>æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨webpackæä¾›äº†externalsé…ç½®æ¥é¿å…æŸäº›æ¨¡å—è¢«webpackæ‰“åŒ…ã€‚ç„¶è€Œï¼Œä¸€ä¸ªé‡è¦çš„é—®é¢˜æ˜¯ï¼Œåœ¨å·²æœ‰çš„commonä»£ç ä¸­æœ‰ä¸€å¥—å‰ç«¯æ¨¡å—åŒ–è¯­æ³•ï¼Œè¦å°†webpackç¼–è¯‘å‡ºæ¥çš„ä»£ç ä¸å·²æœ‰æ¨¡å¼èåˆå­˜åœ¨ä¸€äº›é—®é¢˜ã€‚å› æ­¤è¯¥æ–¹å¼ä¹Ÿå­˜åœ¨ä¸è¶³ã€‚</p>

<p>é’ˆå¯¹ä¸Šé¢çš„æè¿°ï¼Œæ€»ç»“æ¥è¯´ï¼Œæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯ï¼š</p>

<ul>
<li>èƒ½å¤Ÿåœ¨ä»£ç ä¸­ä½¿ç”¨ESMè¯­æ³•ï¼Œæ¥è¿›è¡Œéç¼–è¯‘æœŸåˆ†æçš„æ¨¡å—å¼•ç”¨</li>
<li>ç”±äºwebpackä¼šå°è¯•æ‰“åŒ…è¯¥ä¾èµ–ï¼Œéœ€è¦ä¸ä¼šåœ¨ç¼–è¯‘æœŸå‡ºé”™</li>
</ul>

<h2 id="toc_2">2. è§£å†³æ€è·¯</h2>

<p>åŸºäºä¸Šé¢çš„ç›®æ ‡ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ç§æ–¹å¼èƒ½å¤Ÿæ ‡è¯†ä¸éœ€è¦ç¼–è¯‘çš„è¿è¡ŒæœŸä¾èµ–ã€‚ä¾‹å¦‚<code>util/record</code>è¿™ä¸ªæ¨¡å—ï¼Œå¦‚æœæ˜¯è¿è¡Œæ—¶ä¾èµ–ï¼Œå¯ä»¥å‚è€ƒæ ‡å‡†è¯­æ³•ï¼Œä¸ºæ¨¡å—åæ·»åŠ æ ‡è¯†ï¼š<code>runtime:util/record</code>ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p>

<pre><code class="language-javascript">// ä¸‹é¢è¿™ä¸¤è¡Œæ˜¯æ­£å¸¸çš„ç¼–è¯‘æœŸä¾èµ–
import React from &#39;react&#39;;
import Nav from &#39;./component/nav&#39;;

// ä¸‹é¢è¿™ä¸¤ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›webpackåœ¨ç¼–è¯‘æœŸè¿›è¡Œå¤„ç†
import record from &#39;runtime:util/record&#39;;
import {Banner, List} from &#39;runtime:ui/layout/component&#39;;
</code></pre>

<p>å…¶æ¬¡ï¼Œè™½ç„¶æ ‡è¯†å·²ç»å¯ä»¥è®©å¼€å‘äººå‘˜çŸ¥é“ä»£ç é‡Œå“ªäº›æ¨¡å—æ˜¯webpackéœ€è¦æ‰“åŒ…çš„ä¾èµ–ï¼Œå“ªäº›æ˜¯éç¼–è¯‘æœŸä¾èµ–ï¼›ä½†webpackä¸çŸ¥é“ï¼Œå®ƒåªä¼šæ‹¿åˆ°æ¨¡å—æºç ï¼Œåˆ†æimportè¯­æ³•æ‹¿åˆ°ä¾èµ–ï¼Œç„¶åå°è¯•åŠ è½½ä¾èµ–æ¨¡å—ã€‚ä½†è¿™æ—¶webpackå‚»çœ¼äº†ï¼Œå› ä¸ºåƒ<code>runtime:util/record</code>è¿™æ ·çš„æ¨¡å—æ˜¯è¿è¡Œæ—¶ä¾èµ–ï¼Œç¼–è¯‘æœŸæ‰¾ä¸åˆ°è¯¥æ¨¡å—ã€‚é‚£ä¹ˆï¼Œå°±éœ€è¦é€šè¿‡ä¸€ç§æ–¹å¼ï¼Œè®©webpackâ€œçœ‹ä¸è§â€éç¼–è¯‘æœŸçš„ä¾èµ–ã€‚</p>

<p>æœ€åï¼Œæ‹¿åˆ°éç¼–è¯‘æœŸä¾èµ–ï¼Œç”±äºæµè§ˆå™¨ç°åœ¨è¿˜ä¸æ”¯æŒESMçš„importè¯­æ³•ï¼Œå› æ­¤éœ€è¦å°†å®ƒå˜ä¸ºåœ¨å‰ç«¯è¿è¡Œæ—¶æˆ‘ä»¬è‡ªå®šä¹‰çš„æ¨¡å—ä¾èµ–è¯­æ³•ã€‚</p>

<pre><code class="language-flow">st=&gt;start: å¼€å§‹
op1=&gt;operation: è¯»å–æºç 
op2=&gt;operation: è·å–æ¨¡å—å¯¼å…¥è¯­æ³•
op3=&gt;operation: è¯­æ³•è½¬æ¢
cond=&gt;condition: æ˜¯å¦éç¼–è¯‘æœŸä¾èµ–
e=&gt;end: ç»“æŸ
st-&gt;op1-&gt;op2-&gt;cond
cond(no)-&gt;e
cond(yes)-&gt;op3-&gt;e
</code></pre>

<h2 id="toc_3">3. ä½¿ç”¨babelå¯¹æºç è¿›è¡Œåˆ†æ</h2>

<h3 id="toc_4">3.1. babelç›¸å…³å·¥å…·ä»‹ç»</h3>

<blockquote>
<p>å¯¹babelä»¥åŠæ’ä»¶æœºåˆ¶ä¸å¤ªäº†è§£çš„åŒå­¦ï¼Œå¯ä»¥å…ˆçœ‹è¿™ä¸€éƒ¨åˆ†åšä¸€ä¸ªç®€å•çš„äº†è§£ã€‚</p>
</blockquote>

<p>babelæ˜¯ä¸€ä¸ªå¼ºå¤§çš„javascript compilerï¼Œå¯ä»¥å°†æºç é€šè¿‡è¯æ³•åˆ†æä¸è¯­æ³•åˆ†æè½¬æ¢ä¸ºASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰ï¼Œé€šè¿‡å¯¹ASTè¿›è¡Œè½¬æ¢ï¼Œå¯ä»¥ä¿®æ”¹æºç ï¼Œæœ€åå†å°†ä¿®æ”¹åçš„ASTè½¬æ¢ä¼šç›®æ ‡ä»£ç ã€‚</p>

<p><img src="https://user-gold-cdn.xitu.io/2018/8/17/1654852a672a4d8e?w=2004&amp;h=362&amp;f=png&amp;s=107940" alt=""/></p>

<p>ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæœ¬æ–‡ä¸ä¼šå¯¹compileræˆ–è€…ASTè¿›è¡Œè¿‡å¤šä»‹ç»ï¼Œä½†æ˜¯å¦‚æœä½ å­¦è¿‡ç¼–è¯‘åŸç†ï¼Œé‚£ä¹ˆå¯¹è¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€tokenã€ASTåº”è¯¥éƒ½ä¸ä¼šé™Œç”Ÿã€‚å³ä½¿æ²¡äº†è§£è¿‡ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œä½ å¯ä»¥ç²—ç•¥çš„ç†è§£ä¸ºï¼šbabelæ˜¯ä¸€ä¸ªcompilerï¼Œå®ƒå¯ä»¥å°†javascriptæºç è½¬åŒ–ä¸ºä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯æ ‘ï¼Œä¹Ÿå°±æ˜¯ASTï¼Œå®ƒæ˜¯ä¸€ç§èƒ½å¤Ÿå¾ˆå¥½è¡¨ç¤ºæºç çš„ç»“æ„ã€‚babelçš„ASTæ˜¯åŸºäº<a href="https://github.com/estree/estree">ESTree</a>çš„ã€‚</p>

<p>ä¾‹å¦‚ï¼Œ<code>var alienzhou = &#39;happy&#39;</code>è¿™æ¡è¯­å¥ï¼Œç»è¿‡babelå¤„ç†åå®ƒçš„ASTå¤§æ¦‚æ˜¯ä¸‹é¢è¿™æ ·çš„</p>

<pre><code class="language-javascript">{
    type: &#39;VariableDeclaration&#39;,
    kind: &#39;var&#39;,
    // ...å…¶ä»–å±æ€§
    decolarations: [{
        type: &#39;VariableDeclarator&#39;,
        id: {
            type: &#39;Identifier&#39;,
            name: &#39;alienzhou&#39;,
            // ...å…¶ä»–å±æ€§
        },
        init: {
            type: &#39;StringLiteral&#39;,
            value: &#39;happy&#39;,
            // ...å…¶ä»–å±æ€§
        }
    }],
}
</code></pre>

<p>è¿™éƒ¨åˆ†AST nodeè¡¨ç¤ºï¼Œè¿™æ˜¯ä¸€æ¡å˜é‡å£°æ˜çš„è¯­å¥ï¼Œä½¿ç”¨<code>var</code>å…³é”®å­—ï¼Œå…¶ä¸­idå’Œinitå±æ€§åˆæ˜¯ä¸¤ä¸ªAST nodeï¼Œåˆ†åˆ«æ˜¯åç§°ä¸ºalienzhouçš„æ ‡è¯†ç¬¦ï¼ˆIdentifierï¼‰å’Œå€¼ä¸ºhappyçš„å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆStringLiteralï¼‰ã€‚</p>

<p>è¿™é‡Œï¼Œç®€å•ä»‹ç»ä¸€äº›å¦‚ä½•ä½¿ç”¨babelåŠå…¶æä¾›çš„ä¸€äº›åº“æ¥è¿›è¡ŒASTçš„åˆ†æå’Œä¿®æ”¹ã€‚ç”ŸæˆASTå¯ä»¥é€šè¿‡<code>babel-core</code>é‡Œçš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-javascript">const babel = require(&#39;babel-core&#39;);
const {ast} = babel.transform(`var alienzhou = &#39;happy&#39;`);
</code></pre>

<p>ç„¶åéå†ASTï¼Œæ‰¾åˆ°ç‰¹å®šçš„èŠ‚ç‚¹è¿›è¡Œä¿®æ”¹å³å¯ã€‚babelä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†traverseæ–¹æ³•æ¥éå†ASTï¼š</p>

<pre><code class="language-javascript">const traverse = require(&#39;babel-traverse&#39;).default;
</code></pre>

<p>åœ¨babelä¸­è®¿é—®AST nodeä½¿ç”¨çš„æ˜¯<a href="https://en.wikipedia.org/wiki/Visitor_pattern">vistoræ¨¡å¼</a>ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·æŒ‡å®šAST node typeæ¥è®¿é—®æ‰€éœ€çš„AST nodeï¼š</p>

<pre><code class="language-javascript">traverse(ast, {
    StringLiteral(path) {
        console.log(path.node.value)
        // ...
    }
})
</code></pre>

<p>è¿™æ ·å°±å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„å­—ç¬¦ä¸²å­—é¢é‡ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ›¿æ¢è¿™ä¸ªèŠ‚ç‚¹çš„å†…å®¹ï¼š</p>

<pre><code class="language-javascript">let visitor = {
    StringLiteral(path) {
        console.log(path.node.value)
        path.replaceWith(
            t.stringLiteral(&#39;excited&#39;);
        )
    }
};
traverse(ast, visitor);
</code></pre>

<blockquote>
<p>æ³¨æ„ï¼ŒASTæ˜¯ä¸€ä¸ªmutableå¯¹è±¡ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹æ“ä½œéƒ½ä¼šåœ¨åŸASTä¸Šè¿›è¡Œä¿®æ”¹ã€‚</p>
</blockquote>

<p>è¿™ç¯‡æ–‡ç« ä¸ä¼šè¯¦ç»†ä»‹ç»babel-coreã€babel-traverseçš„APIï¼Œè€Œæ˜¯å¸®åŠ©æ²¡æœ‰æ¥è§¦è¿‡çš„æœ‹å‹å¿«é€Ÿç†è§£å®ƒä»¬ï¼Œå…·ä½“çš„ä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒç›¸å…³æ–‡æ¡£ã€‚</p>

<p>ç”±äºå¤§éƒ¨åˆ†çš„webpacké¡¹ç›®éƒ½ä¼šåœ¨loaderä¸­ä½¿ç”¨babelï¼Œå› æ­¤åªéœ€è¦æä¾›ä¸€ä¸ªbabelçš„æ’ä»¶æ¥å¤„ç†éç¼–è¯‘æœŸä¾èµ–è¯­æ³•å³å¯ã€‚è€Œbabelæ’ä»¶å…¶å®å°±æ˜¯å¯¼å‡ºä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›æˆ‘ä»¬ä¸Šé¢æåˆ°çš„visitorå¯¹è±¡ã€‚</p>

<p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬ä¸“æ³¨äºvisitorçš„ç¼–å†™å³å¯ã€‚</p>

<h3 id="toc_5">3.2 ç¼–å†™ä¸€ä¸ªbabelæ’ä»¶æ¥è§£å†³éç¼–è¯‘æœŸä¾èµ–</h3>

<p>ESMçš„importè¯­æ³•åœ¨AST node typeä¸­æ˜¯<a href="https://github.com/babel/babel/blob/master/packages/babel-parser/ast/spec.md#importdeclaration">ImportDeclaration</a>ï¼š</p>

<pre><code class="language-javascript">export default function () {
    return {
        ImportDeclaration: {
            enter(path) {
                // ...
            }
            exit(path) {
                let source = path.node.source;
                if (t.isStringLiteral(source) &amp;&amp; /^runtime:/.test(source.value)) {
                    // ...
                }
            }
        }
    }
}
</code></pre>

<p>åœ¨enteræ–¹æ³•é‡Œï¼Œéœ€è¦æ”¶é›†ImportDeclarationè¯­æ³•çš„ç›¸å…³ä¿¡æ¯ï¼›åœ¨exitæ–¹æ³•é‡Œï¼Œåˆ¤æ–­å½“å‰ImportDeclarationæ˜¯å¦ä¸ºéç¼–è¯‘æœŸä¾èµ–ï¼Œå¦‚æœæ˜¯åˆ™è¿›è¡Œè¯­æ³•è½¬æ¢ã€‚</p>

<p>æ”¶é›†ImportDeclarationè¯­æ³•ç›¸å…³ä¿¡æ¯éœ€è¦æ³¨æ„ï¼Œå¯¹äºä¸åŒçš„import specifierç±»å‹ï¼Œéœ€è¦ä¸åŒçš„åˆ†ææ–¹å¼ï¼Œä¸‹é¢åˆ—ä¸¾äº†è¿™äº”ç§importï¼š</p>

<pre><code class="language-javascript">import util from &#39;runtime:util&#39;;
import * as util from &#39;runtime:util&#39;;
import {util} from &#39;runtime:util&#39;;
import {util as u} from &#39;runtime:util&#39;;
import &#39;runtime:util&#39;;
</code></pre>

<p>å¯¹åº”äº†ä¸‰ç±»specifierï¼š</p>

<ul>
<li>ImportSpecifierï¼š<code>import {util} from &#39;runtime:util&#39;</code>,<code>import {util as u} from &#39;runtime:util&#39;;</code></li>
<li>ImportDefaultSpecifierï¼š<code>import util from &#39;runtime:util&#39;</code></li>
<li>ImportNamespaceSpecifierï¼š<code>import * as util from &#39;runtime:util&#39;</code></li>
</ul>

<blockquote>
<p><code>import &#39;runtime:util&#39;</code>ä¸­æ²¡æœ‰specifier</p>
</blockquote>

<p>å¯ä»¥åœ¨ImportDeclarationçš„åŸºç¡€ä¸Šï¼Œå¯¹å­èŠ‚ç‚¹è¿›è¡Œtraverseï¼Œè¿™é‡Œæ–°å»ºäº†ä¸€ä¸ªvisitorç”¨æ¥è®¿é—®Specifierï¼Œé’ˆå¯¹ä¸åŒè¯­æ³•è¿›è¡Œæ”¶é›†ï¼š</p>

<pre><code class="language-javascript">const specifierVisitor = {
    ImportNamespaceSpecifier(_path) {
        let data = {
            type: &#39;NAMESPACE&#39;,
            local: _path.node.local.name
        };

        this.specifiers.push(data);
    },

    ImportSpecifier(_path) {
        let data = {
            type: &#39;COMMON&#39;,
            local: _path.node.local.name,
            imported: _path.node.imported ? _path.node.imported.name : null
        };

        this.specifiers.push(data);
    },

    ImportDefaultSpecifier(_path) {
        let data = {
            type: &#39;DEFAULT&#39;,
            local: _path.node.local.name
        };

        this.specifiers.push(data);
    }
}
</code></pre>

<p>åœ¨ImportDeclarationä¸­ä½¿ç”¨specifierVisitorè¿›è¡Œéå†ï¼š</p>

<pre><code class="language-javascript">export default function () {
    // store the specifiers in one importDeclaration
    let specifiers = [];
    return {
        ImportDeclaration: {
            enter(path) {
                path.traverse(specifierVisitor, { specifiers });
            }
            exit(path) {
                let source = path.node.source;
                if (t.isStringLiteral(source) &amp;&amp; /^runtime:/.test(source.value)) {
                    // ...
                }
            }
        }
    }
}
</code></pre>

<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åœ¨è¿›å…¥ImportDeclarationèŠ‚ç‚¹æ—¶ï¼Œæ”¶é›†äº†importè¯­å¥ç›¸å…³ä¿¡æ¯ï¼Œåœ¨é€€å‡ºèŠ‚ç‚¹æ—¶ï¼Œé€šè¿‡åˆ¤æ–­å¯ä»¥çŸ¥é“ç›®å‰èŠ‚ç‚¹æ˜¯å¦æ˜¯éç¼–è¯‘æœŸä¾èµ–ã€‚å› æ­¤ï¼Œå¦‚æœæ˜¯éç¼–è¯‘æœŸä¾èµ–ï¼Œåªéœ€è¦æ ¹æ®æ”¶é›†åˆ°çš„ä¿¡æ¯æ›¿æ¢èŠ‚ç‚¹è¯­æ³•å³å¯ã€‚</p>

<p>ç”Ÿæˆæ–°èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨babel-typesã€‚ä¸è¿‡æ¨èä½¿ç”¨babel-templateï¼Œä¼šä»¤ä»£ç æ›´ç®€ä¾¿ä¸æ¸…æ™°ã€‚ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼Œä¼šæ ¹æ®ä¸åŒçš„importä¿¡æ¯ï¼Œç”Ÿæˆä¸åŒçš„è¿è¡Œæ—¶ä»£ç ï¼Œå…¶ä¸­å‡å®š__my_require__æ–¹æ³•å°±æ˜¯è‡ªå®šä¹‰çš„å‰ç«¯æ¨¡å—requireæ–¹æ³•ã€‚</p>

<pre><code class="language-javascript">const template = require(&#39;babel-template&#39;);

function constructRequireModule({
    local,
    type,
    imported,
    moduleName
}) {

    /* using template instead of origin type functions */
    const namespaceTemplate = template(`
        var LOCAL = __my_require__(MODULE_NAME);
    `);

    const commonTemplate = template(`
        var LOCAL = __my_require__(MODULE_NAME)[IMPORTED];
    `);

    const defaultTemplate = template(`
        var LOCAL = __my_require__(MODULE_NAME)[&#39;default&#39;];
    `);

    const sideTemplate = template(`
        __my_require__(MODULE_NAME);
    `);
    /* ********************************************** */

    let declaration;
    switch (type) {
        case &#39;NAMESPACE&#39;:
            declaration = namespaceTemplate({
                LOCAL: t.identifier(local),
                MODULE_NAME: t.stringLiteral(moduleName)
            });
            break;

        case &#39;COMMON&#39;:
            imported = imported || local;
            declaration = commonTemplate({
                LOCAL: t.identifier(local),
                MODULE_NAME: t.stringLiteral(moduleName),
                IMPORTED: t.stringLiteral(imported)
            });
            break;

        case &#39;DEFAULT&#39;:
            declaration = defaultTemplate({
                LOCAL: t.identifier(local),
                MODULE_NAME: t.stringLiteral(moduleName)
            });
            break;

        case &#39;SIDE&#39;:
            declaration = sideTemplate({
                MODULE_NAME: t.stringLiteral(moduleName)
            })

        default:
            break;
    }

    return declaration;
}
</code></pre>

<p>æœ€åæ•´åˆåˆ°ä¸€å¼€å§‹çš„visitorä¸­ï¼š</p>

<pre><code class="language-javascript">export default function () {
    // store the specifiers in one importDeclaration
    let specifiers = [];
    return {
        ImportDeclaration: {
            enter(path) {
                path.traverse(specifierVisitor, { specifiers });
            }
            exit(path) {
                let source = path.node.source;
                let moduleName = path.node.source.value;
                if (t.isStringLiteral(source) &amp;&amp; /^runtime:/.test(source.value)) {
                    let nodes;
                    if (specifiers.length === 0) {
                        nodes = constructRequireModule({
                            moduleName,
                            type: &#39;SIDE&#39;
                        });
                        nodes = [nodes]
                    }
                    else {
                        nodes = specifiers.map(constructRequireModule);
                    }
                    path.replaceWithMultiple(nodes);
                }
                specifiers = [];
            }
        }
    }
}
</code></pre>

<p>é‚£ä¹ˆï¼Œå¯¹äºä¸€æ®µ<code>import util from &#39;runtime:util&#39;</code>çš„æºç ï¼Œåœ¨è¯¥babelæ’ä»¶ä¿®æ”¹åå˜ä¸ºäº†<code>var util = require(&#39;runtime:util&#39;)[&#39;default&#39;]</code>ï¼Œè¯¥ä»£ç ä¹Ÿä¼šè¢«webpackç›´æ¥è¾“å‡ºã€‚</p>

<p>è¿™æ ·ï¼Œé€šè¿‡babelæ’ä»¶ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†æ–‡ç« æœ€ä¸€å¼€å§‹çš„ç›®æ ‡ã€‚</p>

<h2 id="toc_6">4. å¤„ç†dynamic import</h2>

<p>ç»†å¿ƒçš„è¯»è€…è‚¯å®šä¼šå‘ç°äº†ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢åªè§£å†³äº†é™æ€importçš„é—®é¢˜ï¼Œé‚£ä¹ˆåƒä¸‹é¢è¿™æ ·çš„åŠ¨æ€importä¸æ˜¯ä»ç„¶ä¼šæœ‰ä»¥ä¸Šçš„é—®é¢˜ä¹ˆï¼Ÿ</p>

<pre><code class="language-javascript">import(&#39;runtime:util&#39;).then(u =&gt; {
    u.record(1);
});
</code></pre>

<p>æ˜¯çš„ï¼Œä»ç„¶ä¼šæœ‰é—®é¢˜ã€‚å› æ­¤ï¼Œè¿›ä¸€æ­¥æˆ‘ä»¬è¿˜éœ€è¦å¤„ç†åŠ¨æ€importçš„è¯­æ³•ã€‚è¦åšçš„å°±æ˜¯åœ¨visitorä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„node typeï¼š</p>

<pre><code class="language-javascript">{
    Import: {
        enter(path) {
            let callNode = path.parentPath.node;
            let nameNode = callNode.arguments &amp;&amp; callNode.arguments[0] ? callNode.arguments[0] : null;

            if (t.isCallExpression(callNode)
                &amp;&amp; t.isStringLiteral(nameNode)
                &amp;&amp; /^runtime:/.test(nameNode.value)
            ) {
                let args = callNode.arguments;
                path.parentPath.replaceWith(
                    t.callExpression(
                        t.memberExpression(
                            t.identifier(&#39;__my_require__&#39;), t.identifier(&#39;async&#39;), false),
                            args
                ));
            }
        }
    }
}
</code></pre>

<p>è¿™æ—¶ï¼Œä¸Šé¢çš„åŠ¨æ€importä»£ç å°±ä¼šè¢«æ›¿æ¢ä¸ºï¼š</p>

<pre><code class="language-javascript">__my_require__.async(&#39;runtime:util&#39;).then(u =&gt; {
    u.record(1);
});
</code></pre>

<p>éå¸¸æ–¹ä¾¿å§ã€‚</p>

<h2 id="toc_7">5. å†™åœ¨æœ€å</h2>

<blockquote>
<p>æœ¬æ–‡ç›¸å…³ä»£ç å·²æ‰˜ç®¡è‡³github: <a href="https://github.com/alienzhou/babel-plugin-import-customized-require">babel-plugin-import-customized-require</a></p>
</blockquote>

<p>æœ¬æ–‡æ˜¯ä»ä¸€ä¸ªå…³äºwebpackç¼–è¯‘æœŸçš„éœ€æ±‚å‡ºå‘ï¼Œåº”ç”¨babelæ¥ä½¿ä»£ç ä¸­éƒ¨åˆ†æ¨¡å—ä¾èµ–ä¸åœ¨webpackç¼–è¯‘æœŸè¿›è¡Œå¤„ç†ã€‚å…¶å®ä»ä¸­å¯ä»¥çœ‹å‡ºï¼Œbabelç»™æˆ‘ä»¬èµ‹äºˆäº†æå¤§çš„å¯èƒ½æ€§ã€‚</p>

<p>æ–‡ä¸­è§£å†³çš„é—®é¢˜åªæ˜¯ä¸€ä¸ªå°éœ€æ±‚ï¼Œä¹Ÿè®¸ä½ ä¼šæœ‰æ›´ä¸é”™çš„è§£å†³æ–¹æ¡ˆï¼›ç„¶è€Œè¿™é‡Œæ›´å¤šçš„æ˜¯å±•ç¤ºäº†babelçš„çµæ´»ã€å¼ºå¤§ï¼Œå®ƒç»™å‰ç«¯å¸¦æ¥çš„æ›´å¤šçš„ç©ºé—´ä¸å¯èƒ½æ€§ï¼Œåœ¨è®¸å¤šè¡ç”Ÿçš„é¢†åŸŸä¹Ÿéƒ½èƒ½å‘ç°å®ƒçš„èº«å½±ã€‚å¸Œæœ›æœ¬æ–‡èƒ½æˆä¸ºä¸€ä¸ªå¼•å­ï¼Œä¸ºä½ æ‹“å±•è§£å†³é—®é¢˜çš„å¦ä¸€æ¡æ€è·¯ã€‚</p>

<h2 id="toc_8">å‚è€ƒèµ„æ–™</h2>

<ul>
<li><a href="https://github.com/babel/babel/blob/master/packages/babel-parser/ast/spec.md">Babel AST spec</a></li>
<li><a href="https://en.wikipedia.org/wiki/Visitor_pattern">visitor pattern</a></li>
<li><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/en/plugin-handbook.md">Babel Plugin Handbook</a></li>
<li><a href="http://astexplorer.net/">AST Explorer</a></li>
</ul>


		</div>
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

 
	

  
  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    


  </body>
</html>
